[2022-01-03 04:04:46,423] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-03 04:04:46,439] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-03 04:04:46,439] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-03 04:04:46,440] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-03 04:04:46,440] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-03 04:04:46,456] {taskinstance.py:1259} INFO - Executing <Task(PostgresOperator): tweet_load> on 2021-12-31 01:00:00+00:00
[2022-01-03 04:04:46,463] {standard_task_runner.py:52} INFO - Started process 794 to run task
[2022-01-03 04:04:46,468] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'load_dimensions', 'tweet_load', 'scheduled__2021-12-31T01:00:00+00:00', '--job-id', '21', '--raw', '--subdir', 'DAGS_FOLDER/load_redshift.py', '--cfg-path', '/tmp/tmp_gisi8ru', '--error-file', '/tmp/tmp_zpxu343']
[2022-01-03 04:04:46,469] {standard_task_runner.py:77} INFO - Job 21: Subtask tweet_load
[2022-01-03 04:04:46,549] {logging_mixin.py:109} INFO - Running <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]> on host 2b1d65872a35
[2022-01-03 04:04:46,623] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=test_owner
AIRFLOW_CTX_DAG_ID=load_dimensions
AIRFLOW_CTX_TASK_ID=tweet_load
AIRFLOW_CTX_EXECUTION_DATE=2021-12-31T01:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-12-31T01:00:00+00:00
[2022-01-03 04:04:46,635] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: dev, Login: awsuser, Password: ***, extra: {}
[2022-01-03 04:06:57,519] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/postgres/operators/postgres.py", line 69, in execute
    self.hook.run(self.sql, self.autocommit, parameters=self.parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/hooks/dbapi.py", line 198, in run
    with closing(self.get_conn()) as conn:
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/postgres/hooks/postgres.py", line 115, in get_conn
    self.conn = psycopg2.connect(**conn_args)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: connection to server at "tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com" (172.31.45.95), port 5439 failed: Connection timed out
	Is the server running on that host and accepting TCP/IP connections?

[2022-01-03 04:06:57,539] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=load_dimensions, task_id=tweet_load, execution_date=20211231T010000, start_date=20220103T040446, end_date=20220103T040657
[2022-01-03 04:06:57,566] {standard_task_runner.py:92} ERROR - Failed to execute job 21 for task tweet_load
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/postgres/operators/postgres.py", line 69, in execute
    self.hook.run(self.sql, self.autocommit, parameters=self.parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/hooks/dbapi.py", line 198, in run
    with closing(self.get_conn()) as conn:
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/postgres/hooks/postgres.py", line 115, in get_conn
    self.conn = psycopg2.connect(**conn_args)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: connection to server at "tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com" (172.31.45.95), port 5439 failed: Connection timed out
	Is the server running on that host and accepting TCP/IP connections?

[2022-01-03 04:06:57,594] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-03 04:06:57,636] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-05 05:18:31,404] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 05:18:31,447] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 05:18:31,448] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 05:18:31,449] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-05 05:18:31,449] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 05:18:31,477] {taskinstance.py:1259} INFO - Executing <Task(PostgresOperator): tweet_load> on 2021-12-31 01:00:00+00:00
[2022-01-05 05:18:31,496] {standard_task_runner.py:52} INFO - Started process 2938 to run task
[2022-01-05 05:18:31,515] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'load_dimensions', 'tweet_load', 'scheduled__2021-12-31T01:00:00+00:00', '--job-id', '39', '--raw', '--subdir', 'DAGS_FOLDER/load_redshift.py', '--cfg-path', '/tmp/tmplk45ac5a', '--error-file', '/tmp/tmpfdooqqbc']
[2022-01-05 05:18:31,518] {standard_task_runner.py:77} INFO - Job 39: Subtask tweet_load
[2022-01-05 05:18:31,657] {logging_mixin.py:109} INFO - Running <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]> on host 2b1d65872a35
[2022-01-05 05:18:31,845] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=test_owner
AIRFLOW_CTX_DAG_ID=load_dimensions
AIRFLOW_CTX_TASK_ID=tweet_load
AIRFLOW_CTX_EXECUTION_DATE=2021-12-31T01:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-12-31T01:00:00+00:00
[2022-01-05 05:18:31,893] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 05:18:32,335] {dbapi.py:225} INFO - Running statement: select * test, parameters: None
[2022-01-05 05:18:32,451] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/postgres/operators/postgres.py", line 69, in execute
    self.hook.run(self.sql, self.autocommit, parameters=self.parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/hooks/dbapi.py", line 205, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/hooks/dbapi.py", line 229, in _run_command
    cur.execute(sql_statement)
psycopg2.errors.SyntaxError: syntax error at or near "test"
LINE 1: select * test
                 ^

[2022-01-05 05:18:32,472] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=load_dimensions, task_id=tweet_load, execution_date=20211231T010000, start_date=20220105T051831, end_date=20220105T051832
[2022-01-05 05:18:32,503] {standard_task_runner.py:92} ERROR - Failed to execute job 39 for task tweet_load
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/postgres/operators/postgres.py", line 69, in execute
    self.hook.run(self.sql, self.autocommit, parameters=self.parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/hooks/dbapi.py", line 205, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/hooks/dbapi.py", line 229, in _run_command
    cur.execute(sql_statement)
psycopg2.errors.SyntaxError: syntax error at or near "test"
LINE 1: select * test
                 ^

[2022-01-05 05:18:32,519] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-05 05:18:32,590] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-05 05:23:13,628] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 05:23:13,669] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 05:23:13,669] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 05:23:13,669] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-05 05:23:13,669] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 05:23:13,694] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): tweet_load> on 2021-12-31 01:00:00+00:00
[2022-01-05 05:23:13,701] {standard_task_runner.py:52} INFO - Started process 3237 to run task
[2022-01-05 05:23:13,724] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'load_dimensions', 'tweet_load', 'scheduled__2021-12-31T01:00:00+00:00', '--job-id', '70', '--raw', '--subdir', 'DAGS_FOLDER/load_redshift.py', '--cfg-path', '/tmp/tmpijgz58p8', '--error-file', '/tmp/tmpmuriq80d']
[2022-01-05 05:23:13,725] {standard_task_runner.py:77} INFO - Job 70: Subtask tweet_load
[2022-01-05 05:23:13,845] {logging_mixin.py:109} INFO - Running <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]> on host 2b1d65872a35
[2022-01-05 05:23:14,027] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=test_owner
AIRFLOW_CTX_DAG_ID=load_dimensions
AIRFLOW_CTX_TASK_ID=tweet_load
AIRFLOW_CTX_EXECUTION_DATE=2021-12-31T01:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-12-31T01:00:00+00:00
[2022-01-05 05:23:14,032] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:23:14,032] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:23:14,032] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:23:14,033] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:23:14,033] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:23:14,033] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:23:14,033] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:23:14,033] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:23:14,033] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:23:14,034] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:23:14,034] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:23:14,034] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:23:14,034] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f88b8fac810>, 'dag': <DAG: load_dimensions>, 'dag_run': <DagRun load_dimensions @ 2021-12-31 01:00:00+00:00: scheduled__2021-12-31T01:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2021-12-31', 'ds_nodash': '20211231', 'execution_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2021-12-31', 'next_ds_nodash': '20211231', 'next_execution_date': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': DateTime(2021, 12, 31, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2021-12-31T01:00:00+00:00', 'task': <Task(PythonOperator): tweet_load>, 'task_instance': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'task_instance_key_str': 'load_dimensions__tweet_load__20211231', 'test_mode': False, 'ti': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-01', 'tomorrow_ds_nodash': '20220101', 'ts': '2021-12-31T01:00:00+00:00', 'ts_nodash': '20211231T010000', 'ts_nodash_with_tz': '20211231T010000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-30', 'yesterday_ds_nodash': '20211230', 'key': 'value', 'ts_var': '2021-12-31T01:00:00+00:00', 'tsnodash_var': '20211231T010000', 'templates_dict': None}
[2022-01-05 05:23:14,034] {logging_mixin.py:109} INFO - Hello, Current Time:05:23:14 Execution time is 2021-12-31T01:00:00+00:00
[2022-01-05 05:23:14,077] {logging_mixin.py:109} INFO -    Unnamed: 0  ...       location
0           0  ...            NaN
1           1  ...            NaN
2           2  ...            NaN
3           3  ...      UofGuelph
4           4  ...            NaN
5           5  ...  Westbrook, ME
6           6  ...            NaN
7           7  ...            NaN
8           8  ...            NaN
9           9  ...   General Roca

[10 rows x 6 columns]
[2022-01-05 05:23:14,116] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 05:23:14,180] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 05:23:14,759] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2336, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 364, in connect
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 778, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 495, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 140, in _do_get
    self._dec_overflow()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 137, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 309, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 440, in __init__
    self.__connect(first_connect_check=True)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 661, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 656, in __connect
    connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/strategies.py", line 114, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 508, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: connection to server at "tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com" (3.132.179.48), port 5439 failed: FATAL:  password authentication failed for user "awsuser"
connection to server at "tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com" (3.132.179.48), port 5439 failed: FATAL:  password authentication failed for user "awsuser"


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/load_redshift.py", line 139, in load_tweets
    df.to_sql('test', redshift_hook.get_sqlalchemy_engine(), if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1758, in to_sql
    dtype=dtype,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1650, in prep_table
    table.create()
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 856, in create
    if self.exists():
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 840, in exists
    return self.pd_sql.has_table(self.name, self.schema)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1787, in has_table
    self.connectable.dialect.has_table, name, schema or self.meta.schema
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2211, in run_callable
    with self._contextual_connect() as conn:
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2302, in _contextual_connect
    self._wrap_pool_connect(self.pool.connect, None),
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2340, in _wrap_pool_connect
    e, dialect, self
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1584, in _handle_dbapi_exception_noconnection
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2336, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 364, in connect
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 778, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 495, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 140, in _do_get
    self._dec_overflow()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 137, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 309, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 440, in __init__
    self.__connect(first_connect_check=True)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 661, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 656, in __connect
    connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/strategies.py", line 114, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 508, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com" (3.132.179.48), port 5439 failed: FATAL:  password authentication failed for user "awsuser"
connection to server at "tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com" (3.132.179.48), port 5439 failed: FATAL:  password authentication failed for user "awsuser"

(Background on this error at: http://sqlalche.me/e/13/e3q8)
[2022-01-05 05:23:14,803] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=load_dimensions, task_id=tweet_load, execution_date=20211231T010000, start_date=20220105T052313, end_date=20220105T052314
[2022-01-05 05:23:14,829] {standard_task_runner.py:92} ERROR - Failed to execute job 70 for task tweet_load
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2336, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 364, in connect
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 778, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 495, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 140, in _do_get
    self._dec_overflow()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 137, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 309, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 440, in __init__
    self.__connect(first_connect_check=True)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 661, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 656, in __connect
    connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/strategies.py", line 114, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 508, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: connection to server at "tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com" (3.132.179.48), port 5439 failed: FATAL:  password authentication failed for user "awsuser"
connection to server at "tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com" (3.132.179.48), port 5439 failed: FATAL:  password authentication failed for user "awsuser"


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/load_redshift.py", line 139, in load_tweets
    df.to_sql('test', redshift_hook.get_sqlalchemy_engine(), if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1758, in to_sql
    dtype=dtype,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1650, in prep_table
    table.create()
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 856, in create
    if self.exists():
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 840, in exists
    return self.pd_sql.has_table(self.name, self.schema)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1787, in has_table
    self.connectable.dialect.has_table, name, schema or self.meta.schema
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2211, in run_callable
    with self._contextual_connect() as conn:
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2302, in _contextual_connect
    self._wrap_pool_connect(self.pool.connect, None),
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2340, in _wrap_pool_connect
    e, dialect, self
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1584, in _handle_dbapi_exception_noconnection
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2336, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 364, in connect
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 778, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 495, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 140, in _do_get
    self._dec_overflow()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 137, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 309, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 440, in __init__
    self.__connect(first_connect_check=True)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 661, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 656, in __connect
    connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/strategies.py", line 114, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 508, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com" (3.132.179.48), port 5439 failed: FATAL:  password authentication failed for user "awsuser"
connection to server at "tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com" (3.132.179.48), port 5439 failed: FATAL:  password authentication failed for user "awsuser"

(Background on this error at: http://sqlalche.me/e/13/e3q8)
[2022-01-05 05:23:14,844] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-05 05:23:14,993] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-05 05:35:10,847] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 05:35:10,870] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 05:35:10,871] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 05:35:10,871] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-05 05:35:10,871] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 05:35:10,900] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): tweet_load> on 2021-12-31 01:00:00+00:00
[2022-01-05 05:35:10,921] {standard_task_runner.py:52} INFO - Started process 224 to run task
[2022-01-05 05:35:10,948] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'load_dimensions', 'tweet_load', 'scheduled__2021-12-31T01:00:00+00:00', '--job-id', '105', '--raw', '--subdir', 'DAGS_FOLDER/load_redshift.py', '--cfg-path', '/tmp/tmpc0hbucc9', '--error-file', '/tmp/tmphh_r1zo9']
[2022-01-05 05:35:10,950] {standard_task_runner.py:77} INFO - Job 105: Subtask tweet_load
[2022-01-05 05:35:11,087] {logging_mixin.py:109} INFO - Running <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]> on host 2b1d65872a35
[2022-01-05 05:35:11,203] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=test_owner
AIRFLOW_CTX_DAG_ID=load_dimensions
AIRFLOW_CTX_TASK_ID=tweet_load
AIRFLOW_CTX_EXECUTION_DATE=2021-12-31T01:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-12-31T01:00:00+00:00
[2022-01-05 05:35:11,205] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:35:11,206] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:35:11,206] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:35:11,206] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:35:11,206] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:35:11,206] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:35:11,206] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:35:11,207] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:35:11,207] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:35:11,207] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:35:11,207] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:35:11,207] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:35:11,208] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7fd8b40b1950>, 'dag': <DAG: load_dimensions>, 'dag_run': <DagRun load_dimensions @ 2021-12-31 01:00:00+00:00: scheduled__2021-12-31T01:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2021-12-31', 'ds_nodash': '20211231', 'execution_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2021-12-31', 'next_ds_nodash': '20211231', 'next_execution_date': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': DateTime(2021, 12, 31, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2021-12-31T01:00:00+00:00', 'task': <Task(PythonOperator): tweet_load>, 'task_instance': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'task_instance_key_str': 'load_dimensions__tweet_load__20211231', 'test_mode': False, 'ti': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-01', 'tomorrow_ds_nodash': '20220101', 'ts': '2021-12-31T01:00:00+00:00', 'ts_nodash': '20211231T010000', 'ts_nodash_with_tz': '20211231T010000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-30', 'yesterday_ds_nodash': '20211230', 'key': 'value', 'ts_var': '2021-12-31T01:00:00+00:00', 'tsnodash_var': '20211231T010000', 'templates_dict': None}
[2022-01-05 05:35:11,211] {logging_mixin.py:109} INFO - Hello, Current Time:05:35:11 Execution time is 2021-12-31T01:00:00+00:00
[2022-01-05 05:35:11,250] {logging_mixin.py:109} INFO -    Unnamed: 0  ...       location
0           0  ...            NaN
1           1  ...            NaN
2           2  ...            NaN
3           3  ...      UofGuelph
4           4  ...            NaN
5           5  ...  Westbrook, ME
6           6  ...            NaN
7           7  ...            NaN
8           8  ...            NaN
9           9  ...   General Roca

[10 rows x 6 columns]
[2022-01-05 05:35:11,283] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 05:35:11,294] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 05:35:13,194] {python.py:175} INFO - Done. Returned value was: None
[2022-01-05 05:35:13,207] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=load_dimensions, task_id=tweet_load, execution_date=20211231T010000, start_date=20220105T053510, end_date=20220105T053513
[2022-01-05 05:35:13,242] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-05 05:35:13,277] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-05 05:49:55,183] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 05:49:55,204] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 05:49:55,205] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 05:49:55,205] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-05 05:49:55,205] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 05:49:55,252] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): tweet_load> on 2021-12-31 01:00:00+00:00
[2022-01-05 05:49:55,274] {standard_task_runner.py:52} INFO - Started process 924 to run task
[2022-01-05 05:49:55,292] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'load_dimensions', 'tweet_load', 'scheduled__2021-12-31T01:00:00+00:00', '--job-id', '126', '--raw', '--subdir', 'DAGS_FOLDER/load_redshift.py', '--cfg-path', '/tmp/tmpic077s0z', '--error-file', '/tmp/tmp6nf1wjx_']
[2022-01-05 05:49:55,293] {standard_task_runner.py:77} INFO - Job 126: Subtask tweet_load
[2022-01-05 05:49:55,443] {logging_mixin.py:109} INFO - Running <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]> on host 2b1d65872a35
[2022-01-05 05:49:55,568] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=test_owner
AIRFLOW_CTX_DAG_ID=load_dimensions
AIRFLOW_CTX_TASK_ID=tweet_load
AIRFLOW_CTX_EXECUTION_DATE=2021-12-31T01:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-12-31T01:00:00+00:00
[2022-01-05 05:49:55,572] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:49:55,572] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:49:55,572] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:49:55,573] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:49:55,573] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:49:55,573] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:49:55,573] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:49:55,573] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:49:55,573] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:49:55,574] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:49:55,574] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:49:55,574] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:49:55,574] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7fd8b40b1950>, 'dag': <DAG: load_dimensions>, 'dag_run': <DagRun load_dimensions @ 2021-12-31 01:00:00+00:00: scheduled__2021-12-31T01:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2021-12-31', 'ds_nodash': '20211231', 'execution_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2021-12-31', 'next_ds_nodash': '20211231', 'next_execution_date': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': DateTime(2021, 12, 31, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2021-12-31T01:00:00+00:00', 'task': <Task(PythonOperator): tweet_load>, 'task_instance': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'task_instance_key_str': 'load_dimensions__tweet_load__20211231', 'test_mode': False, 'ti': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-01', 'tomorrow_ds_nodash': '20220101', 'ts': '2021-12-31T01:00:00+00:00', 'ts_nodash': '20211231T010000', 'ts_nodash_with_tz': '20211231T010000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-30', 'yesterday_ds_nodash': '20211230', 'key': 'value', 'ts_var': '2021-12-31T01:00:00+00:00', 'tsnodash_var': '20211231T010000', 'templates_dict': None}
[2022-01-05 05:49:55,575] {logging_mixin.py:109} INFO - Hello, Current Time:05:49:55 Execution time is 2021-12-31T01:00:00+00:00
[2022-01-05 05:49:55,602] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 05:49:55,613] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 05:49:57,023] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
psycopg2.errors.UndefinedColumn: column "unnamed: 0" of relation "tweet" does not exist


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/load_redshift.py", line 133, in load_tweets
    tweet_data.to_sql('tweet', redshift_hook.get_sqlalchemy_engine(), if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1350, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 882, in _execute_insert
    conn.execute(self.table.insert(), data)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1011, in execute
    return meth(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 298, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1130, in _execute_clauseelement
    distilled_params,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1317, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1511, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "unnamed: 0" of relation "tweet" does not exist

[SQL: INSERT INTO tweet ("Unnamed: 0", created_at, author_id, id, original_text, location) VALUES (%(Unnamed: 0)s, %(created_at)s, %(author_id)s, %(id)s, %(original_text)s, %(location)s)]
[parameters: ({'Unnamed: 0': 0, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1284477302223634433, 'id': 1476722269833633800, 'original_text': "One common #OriginOfCovid misunderstanding is that early Covid-19 cases were linked to market stalls selling wildlife.\n\nThere's actually no data to support the claim, and the data provided by the China-@WHO joint study, whether you trust it or not, contradicts the claim.", 'location': 'California'}, {'Unnamed: 0': 1, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 127997053, 'id': 1476722269766492163, 'original_text': 'Por favor cuídate del covid y no beses a nadie que no sea yo el viernes', 'location': None}, {'Unnamed: 0': 2, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1321873703785930754, 'id': 1476722269720305664, 'original_text': 'BREAKING: Florida mayor Jerry Demmings blasts Governor DeSantis, accuses him of cowering and hiding as his reckless COVID policies backfire and the Omicron variant ravages the state, asking, “Where is Ron DeSantis now!?” RT TO THANK MAYOR DEMMINGS FOR CALLING DEATHSANTIS OUT!', 'location': 'Eastern NC'}, {'Unnamed: 0': 3, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1056811681899257857, 'id': 1476722269627899906, 'original_text': 'Follow The Science? Twitter Suspends mRNA Vaccine Inventor Dr. Robert Malone Who Questioned COVID Jab https://t.co/EOuda8tNja via @redvoicemedias', 'location': 'White Rabbit St, MATRIX '}, {'Unnamed: 0': 4, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 759804041459273728, 'id': 1476722269464498178, 'original_text': "@Nanookbn @RLurieCTV good news for us, we aren't getting sick, it's all of you who took the experimental that are super spreaders now. How does it feel to have risked your life, lost your freedoms and visitors prohibited and curfew.  Nothing changed but your health!", 'location': 'Montréal, Québec'}, {'Unnamed: 0': 5, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 218854536, 'id': 1476722269346877441, 'original_text': 'JUST IN\n\nThe group behind the #Lawan series of protests are suing the govt and police for alleged violations of fundamental liberties during a Covi ... (7 characters truncated) ... ndlelight vigil held earlier this year.\n\nIn August, 30 people were hauled up and compounded for participating in the event. https://t.co/gRQqgsxZPZ', 'location': 'malaysia'}, {'Unnamed: 0': 6, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1135956772282413056, 'id': 1476722269288337415, 'original_text': 'Un día más sin pillar el covid.\nUn día menos para pillarlo.', 'location': 'Islas Canarias'}, {'Unnamed: 0': 7, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 987480088961691648, 'id': 1476722269246263296, 'original_text': '"The Amarillo Public Health Department reported  17 new deaths in Wednesday\'s COVID-19 report card." This is what happens when your Congressman spews disinformation about the effectiveness of vaccinations and masks. @RonnyJacksonTX', 'location': None}, {'Unnamed: 0': 8, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1450632043, 'id': 1476722269179154435, 'original_text': 'The U.S. just reported 484,377 new covid cases, the world record for the whole pandemic. And our government’s response is to get people back to work.', 'location': 'amor fati'}, {'Unnamed: 0': 9, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1307340897680584705, 'id': 1476722269166710787, 'original_text': '#EnVideo📹| COVID-19 | Venezuela registró 200 casos comunitarios, 3 importados y 433.208 pacientes recuperados\n\n#AbrazaLaVida \n\nhttps://t.co/tXRZTmdeGh', 'location': None})]
(Background on this error at: http://sqlalche.me/e/13/f405)
[2022-01-05 05:49:57,050] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=load_dimensions, task_id=tweet_load, execution_date=20211231T010000, start_date=20220105T054955, end_date=20220105T054957
[2022-01-05 05:49:57,075] {standard_task_runner.py:92} ERROR - Failed to execute job 126 for task tweet_load
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
psycopg2.errors.UndefinedColumn: column "unnamed: 0" of relation "tweet" does not exist


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/load_redshift.py", line 133, in load_tweets
    tweet_data.to_sql('tweet', redshift_hook.get_sqlalchemy_engine(), if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1350, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 882, in _execute_insert
    conn.execute(self.table.insert(), data)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1011, in execute
    return meth(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 298, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1130, in _execute_clauseelement
    distilled_params,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1317, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1511, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "unnamed: 0" of relation "tweet" does not exist

[SQL: INSERT INTO tweet ("Unnamed: 0", created_at, author_id, id, original_text, location) VALUES (%(Unnamed: 0)s, %(created_at)s, %(author_id)s, %(id)s, %(original_text)s, %(location)s)]
[parameters: ({'Unnamed: 0': 0, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1284477302223634433, 'id': 1476722269833633800, 'original_text': "One common #OriginOfCovid misunderstanding is that early Covid-19 cases were linked to market stalls selling wildlife.\n\nThere's actually no data to support the claim, and the data provided by the China-@WHO joint study, whether you trust it or not, contradicts the claim.", 'location': 'California'}, {'Unnamed: 0': 1, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 127997053, 'id': 1476722269766492163, 'original_text': 'Por favor cuídate del covid y no beses a nadie que no sea yo el viernes', 'location': None}, {'Unnamed: 0': 2, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1321873703785930754, 'id': 1476722269720305664, 'original_text': 'BREAKING: Florida mayor Jerry Demmings blasts Governor DeSantis, accuses him of cowering and hiding as his reckless COVID policies backfire and the Omicron variant ravages the state, asking, “Where is Ron DeSantis now!?” RT TO THANK MAYOR DEMMINGS FOR CALLING DEATHSANTIS OUT!', 'location': 'Eastern NC'}, {'Unnamed: 0': 3, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1056811681899257857, 'id': 1476722269627899906, 'original_text': 'Follow The Science? Twitter Suspends mRNA Vaccine Inventor Dr. Robert Malone Who Questioned COVID Jab https://t.co/EOuda8tNja via @redvoicemedias', 'location': 'White Rabbit St, MATRIX '}, {'Unnamed: 0': 4, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 759804041459273728, 'id': 1476722269464498178, 'original_text': "@Nanookbn @RLurieCTV good news for us, we aren't getting sick, it's all of you who took the experimental that are super spreaders now. How does it feel to have risked your life, lost your freedoms and visitors prohibited and curfew.  Nothing changed but your health!", 'location': 'Montréal, Québec'}, {'Unnamed: 0': 5, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 218854536, 'id': 1476722269346877441, 'original_text': 'JUST IN\n\nThe group behind the #Lawan series of protests are suing the govt and police for alleged violations of fundamental liberties during a Covi ... (7 characters truncated) ... ndlelight vigil held earlier this year.\n\nIn August, 30 people were hauled up and compounded for participating in the event. https://t.co/gRQqgsxZPZ', 'location': 'malaysia'}, {'Unnamed: 0': 6, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1135956772282413056, 'id': 1476722269288337415, 'original_text': 'Un día más sin pillar el covid.\nUn día menos para pillarlo.', 'location': 'Islas Canarias'}, {'Unnamed: 0': 7, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 987480088961691648, 'id': 1476722269246263296, 'original_text': '"The Amarillo Public Health Department reported  17 new deaths in Wednesday\'s COVID-19 report card." This is what happens when your Congressman spews disinformation about the effectiveness of vaccinations and masks. @RonnyJacksonTX', 'location': None}, {'Unnamed: 0': 8, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1450632043, 'id': 1476722269179154435, 'original_text': 'The U.S. just reported 484,377 new covid cases, the world record for the whole pandemic. And our government’s response is to get people back to work.', 'location': 'amor fati'}, {'Unnamed: 0': 9, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1307340897680584705, 'id': 1476722269166710787, 'original_text': '#EnVideo📹| COVID-19 | Venezuela registró 200 casos comunitarios, 3 importados y 433.208 pacientes recuperados\n\n#AbrazaLaVida \n\nhttps://t.co/tXRZTmdeGh', 'location': None})]
(Background on this error at: http://sqlalche.me/e/13/f405)
[2022-01-05 05:49:57,107] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-05 05:49:57,345] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-05 05:51:29,488] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 05:51:29,508] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 05:51:29,508] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 05:51:29,509] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-05 05:51:29,509] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 05:51:29,538] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): tweet_load> on 2021-12-31 01:00:00+00:00
[2022-01-05 05:51:29,550] {standard_task_runner.py:52} INFO - Started process 1049 to run task
[2022-01-05 05:51:29,575] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'load_dimensions', 'tweet_load', 'scheduled__2021-12-31T01:00:00+00:00', '--job-id', '142', '--raw', '--subdir', 'DAGS_FOLDER/load_redshift.py', '--cfg-path', '/tmp/tmpch3ynkt3', '--error-file', '/tmp/tmp9wy6m9mp']
[2022-01-05 05:51:29,576] {standard_task_runner.py:77} INFO - Job 142: Subtask tweet_load
[2022-01-05 05:51:29,688] {logging_mixin.py:109} INFO - Running <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]> on host 2b1d65872a35
[2022-01-05 05:51:29,851] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=test_owner
AIRFLOW_CTX_DAG_ID=load_dimensions
AIRFLOW_CTX_TASK_ID=tweet_load
AIRFLOW_CTX_EXECUTION_DATE=2021-12-31T01:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-12-31T01:00:00+00:00
[2022-01-05 05:51:29,856] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:51:29,856] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:51:29,857] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:51:29,857] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:51:29,857] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:51:29,857] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:51:29,858] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:51:29,858] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:51:29,858] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:51:29,859] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:51:29,859] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:51:29,859] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 05:51:29,860] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7fd8b40b1950>, 'dag': <DAG: load_dimensions>, 'dag_run': <DagRun load_dimensions @ 2021-12-31 01:00:00+00:00: scheduled__2021-12-31T01:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2021-12-31', 'ds_nodash': '20211231', 'execution_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2021-12-31', 'next_ds_nodash': '20211231', 'next_execution_date': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': DateTime(2021, 12, 31, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2021-12-31T01:00:00+00:00', 'task': <Task(PythonOperator): tweet_load>, 'task_instance': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'task_instance_key_str': 'load_dimensions__tweet_load__20211231', 'test_mode': False, 'ti': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-01', 'tomorrow_ds_nodash': '20220101', 'ts': '2021-12-31T01:00:00+00:00', 'ts_nodash': '20211231T010000', 'ts_nodash_with_tz': '20211231T010000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-30', 'yesterday_ds_nodash': '20211230', 'key': 'value', 'ts_var': '2021-12-31T01:00:00+00:00', 'tsnodash_var': '20211231T010000', 'templates_dict': None}
[2022-01-05 05:51:29,860] {logging_mixin.py:109} INFO - Hello, Current Time:05:51:29 Execution time is 2021-12-31T01:00:00+00:00
[2022-01-05 05:51:29,928] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 05:51:29,943] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 05:51:31,313] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
psycopg2.errors.UndefinedColumn: column "original_text" of relation "tweet" does not exist


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/load_redshift.py", line 133, in load_tweets
    tweet_data.to_sql('tweet', redshift_hook.get_sqlalchemy_engine(), if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1350, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 882, in _execute_insert
    conn.execute(self.table.insert(), data)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1011, in execute
    return meth(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 298, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1130, in _execute_clauseelement
    distilled_params,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1317, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1511, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "original_text" of relation "tweet" does not exist

[SQL: INSERT INTO tweet (created_at, author_id, id, original_text, location) VALUES (%(created_at)s, %(author_id)s, %(id)s, %(original_text)s, %(location)s)]
[parameters: ({'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1284477302223634433, 'id': 1476722269833633800, 'original_text': "One common #OriginOfCovid misunderstanding is that early Covid-19 cases were linked to market stalls selling wildlife.\n\nThere's actually no data to support the claim, and the data provided by the China-@WHO joint study, whether you trust it or not, contradicts the claim.", 'location': 'California'}, {'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 127997053, 'id': 1476722269766492163, 'original_text': 'Por favor cuídate del covid y no beses a nadie que no sea yo el viernes', 'location': None}, {'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1321873703785930754, 'id': 1476722269720305664, 'original_text': 'BREAKING: Florida mayor Jerry Demmings blasts Governor DeSantis, accuses him of cowering and hiding as his reckless COVID policies backfire and the Omicron variant ravages the state, asking, “Where is Ron DeSantis now!?” RT TO THANK MAYOR DEMMINGS FOR CALLING DEATHSANTIS OUT!', 'location': 'Eastern NC'}, {'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1056811681899257857, 'id': 1476722269627899906, 'original_text': 'Follow The Science? Twitter Suspends mRNA Vaccine Inventor Dr. Robert Malone Who Questioned COVID Jab https://t.co/EOuda8tNja via @redvoicemedias', 'location': 'White Rabbit St, MATRIX '}, {'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 759804041459273728, 'id': 1476722269464498178, 'original_text': "@Nanookbn @RLurieCTV good news for us, we aren't getting sick, it's all of you who took the experimental that are super spreaders now. How does it feel to have risked your life, lost your freedoms and visitors prohibited and curfew.  Nothing changed but your health!", 'location': 'Montréal, Québec'}, {'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 218854536, 'id': 1476722269346877441, 'original_text': 'JUST IN\n\nThe group behind the #Lawan series of protests are suing the govt and police for alleged violations of fundamental liberties during a Covi ... (7 characters truncated) ... ndlelight vigil held earlier this year.\n\nIn August, 30 people were hauled up and compounded for participating in the event. https://t.co/gRQqgsxZPZ', 'location': 'malaysia'}, {'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1135956772282413056, 'id': 1476722269288337415, 'original_text': 'Un día más sin pillar el covid.\nUn día menos para pillarlo.', 'location': 'Islas Canarias'}, {'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 987480088961691648, 'id': 1476722269246263296, 'original_text': '"The Amarillo Public Health Department reported  17 new deaths in Wednesday\'s COVID-19 report card." This is what happens when your Congressman spews disinformation about the effectiveness of vaccinations and masks. @RonnyJacksonTX', 'location': None}, {'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1450632043, 'id': 1476722269179154435, 'original_text': 'The U.S. just reported 484,377 new covid cases, the world record for the whole pandemic. And our government’s response is to get people back to work.', 'location': 'amor fati'}, {'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1307340897680584705, 'id': 1476722269166710787, 'original_text': '#EnVideo📹| COVID-19 | Venezuela registró 200 casos comunitarios, 3 importados y 433.208 pacientes recuperados\n\n#AbrazaLaVida \n\nhttps://t.co/tXRZTmdeGh', 'location': None})]
(Background on this error at: http://sqlalche.me/e/13/f405)
[2022-01-05 05:51:31,346] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=load_dimensions, task_id=tweet_load, execution_date=20211231T010000, start_date=20220105T055129, end_date=20220105T055131
[2022-01-05 05:51:31,380] {standard_task_runner.py:92} ERROR - Failed to execute job 142 for task tweet_load
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
psycopg2.errors.UndefinedColumn: column "original_text" of relation "tweet" does not exist


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/load_redshift.py", line 133, in load_tweets
    tweet_data.to_sql('tweet', redshift_hook.get_sqlalchemy_engine(), if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1350, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 882, in _execute_insert
    conn.execute(self.table.insert(), data)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1011, in execute
    return meth(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 298, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1130, in _execute_clauseelement
    distilled_params,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1317, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1511, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "original_text" of relation "tweet" does not exist

[SQL: INSERT INTO tweet (created_at, author_id, id, original_text, location) VALUES (%(created_at)s, %(author_id)s, %(id)s, %(original_text)s, %(location)s)]
[parameters: ({'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1284477302223634433, 'id': 1476722269833633800, 'original_text': "One common #OriginOfCovid misunderstanding is that early Covid-19 cases were linked to market stalls selling wildlife.\n\nThere's actually no data to support the claim, and the data provided by the China-@WHO joint study, whether you trust it or not, contradicts the claim.", 'location': 'California'}, {'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 127997053, 'id': 1476722269766492163, 'original_text': 'Por favor cuídate del covid y no beses a nadie que no sea yo el viernes', 'location': None}, {'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1321873703785930754, 'id': 1476722269720305664, 'original_text': 'BREAKING: Florida mayor Jerry Demmings blasts Governor DeSantis, accuses him of cowering and hiding as his reckless COVID policies backfire and the Omicron variant ravages the state, asking, “Where is Ron DeSantis now!?” RT TO THANK MAYOR DEMMINGS FOR CALLING DEATHSANTIS OUT!', 'location': 'Eastern NC'}, {'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1056811681899257857, 'id': 1476722269627899906, 'original_text': 'Follow The Science? Twitter Suspends mRNA Vaccine Inventor Dr. Robert Malone Who Questioned COVID Jab https://t.co/EOuda8tNja via @redvoicemedias', 'location': 'White Rabbit St, MATRIX '}, {'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 759804041459273728, 'id': 1476722269464498178, 'original_text': "@Nanookbn @RLurieCTV good news for us, we aren't getting sick, it's all of you who took the experimental that are super spreaders now. How does it feel to have risked your life, lost your freedoms and visitors prohibited and curfew.  Nothing changed but your health!", 'location': 'Montréal, Québec'}, {'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 218854536, 'id': 1476722269346877441, 'original_text': 'JUST IN\n\nThe group behind the #Lawan series of protests are suing the govt and police for alleged violations of fundamental liberties during a Covi ... (7 characters truncated) ... ndlelight vigil held earlier this year.\n\nIn August, 30 people were hauled up and compounded for participating in the event. https://t.co/gRQqgsxZPZ', 'location': 'malaysia'}, {'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1135956772282413056, 'id': 1476722269288337415, 'original_text': 'Un día más sin pillar el covid.\nUn día menos para pillarlo.', 'location': 'Islas Canarias'}, {'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 987480088961691648, 'id': 1476722269246263296, 'original_text': '"The Amarillo Public Health Department reported  17 new deaths in Wednesday\'s COVID-19 report card." This is what happens when your Congressman spews disinformation about the effectiveness of vaccinations and masks. @RonnyJacksonTX', 'location': None}, {'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1450632043, 'id': 1476722269179154435, 'original_text': 'The U.S. just reported 484,377 new covid cases, the world record for the whole pandemic. And our government’s response is to get people back to work.', 'location': 'amor fati'}, {'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1307340897680584705, 'id': 1476722269166710787, 'original_text': '#EnVideo📹| COVID-19 | Venezuela registró 200 casos comunitarios, 3 importados y 433.208 pacientes recuperados\n\n#AbrazaLaVida \n\nhttps://t.co/tXRZTmdeGh', 'location': None})]
(Background on this error at: http://sqlalche.me/e/13/f405)
[2022-01-05 05:51:31,404] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-05 05:51:31,516] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-05 06:00:46,316] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 06:00:46,336] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 06:00:46,336] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 06:00:46,336] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-05 06:00:46,336] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 06:00:46,352] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): tweet_load> on 2021-12-31 01:00:00+00:00
[2022-01-05 06:00:46,360] {standard_task_runner.py:52} INFO - Started process 1509 to run task
[2022-01-05 06:00:46,366] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'load_dimensions', 'tweet_load', 'scheduled__2021-12-31T01:00:00+00:00', '--job-id', '162', '--raw', '--subdir', 'DAGS_FOLDER/load_redshift.py', '--cfg-path', '/tmp/tmpn_br0wpp', '--error-file', '/tmp/tmp_qyegih2']
[2022-01-05 06:00:46,368] {standard_task_runner.py:77} INFO - Job 162: Subtask tweet_load
[2022-01-05 06:00:46,490] {logging_mixin.py:109} INFO - Running <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]> on host 2b1d65872a35
[2022-01-05 06:00:46,643] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=test_owner
AIRFLOW_CTX_DAG_ID=load_dimensions
AIRFLOW_CTX_TASK_ID=tweet_load
AIRFLOW_CTX_EXECUTION_DATE=2021-12-31T01:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-12-31T01:00:00+00:00
[2022-01-05 06:00:46,644] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:00:46,645] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:00:46,645] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:00:46,645] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:00:46,645] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:00:46,645] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:00:46,646] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:00:46,646] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:00:46,646] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:00:46,646] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:00:46,646] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:00:46,646] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:00:46,648] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7fd8b40b1950>, 'dag': <DAG: load_dimensions>, 'dag_run': <DagRun load_dimensions @ 2021-12-31 01:00:00+00:00: scheduled__2021-12-31T01:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2021-12-31', 'ds_nodash': '20211231', 'execution_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2021-12-31', 'next_ds_nodash': '20211231', 'next_execution_date': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': DateTime(2021, 12, 31, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2021-12-31T01:00:00+00:00', 'task': <Task(PythonOperator): tweet_load>, 'task_instance': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'task_instance_key_str': 'load_dimensions__tweet_load__20211231', 'test_mode': False, 'ti': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-01', 'tomorrow_ds_nodash': '20220101', 'ts': '2021-12-31T01:00:00+00:00', 'ts_nodash': '20211231T010000', 'ts_nodash_with_tz': '20211231T010000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-30', 'yesterday_ds_nodash': '20211230', 'key': 'value', 'ts_var': '2021-12-31T01:00:00+00:00', 'tsnodash_var': '20211231T010000', 'templates_dict': None}
[2022-01-05 06:00:46,648] {logging_mixin.py:109} INFO - Hello, Current Time:06:00:46 Execution time is 2021-12-31T01:00:00+00:00
[2022-01-05 06:00:46,682] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 06:00:46,694] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 06:00:48,103] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
psycopg2.errors.NumericValueOutOfRange: numeric value "1284477302223634433" out of range for integer


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/load_redshift.py", line 133, in load_tweets
    tweet_data.to_sql('tweet', redshift_hook.get_sqlalchemy_engine(), if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1350, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 882, in _execute_insert
    conn.execute(self.table.insert(), data)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1011, in execute
    return meth(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 298, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1130, in _execute_clauseelement
    distilled_params,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1317, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1511, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (psycopg2.errors.NumericValueOutOfRange) numeric value "1284477302223634433" out of range for integer

[SQL: INSERT INTO tweet (author_id, created_at, id, original_text, location) VALUES (%(author_id)s, %(created_at)s, %(id)s, %(original_text)s, %(location)s)]
[parameters: ({'author_id': 1284477302223634433, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1476722269833633800, 'original_text': "One common #OriginOfCovid misunderstanding is that early Covid-19 cases were linked to market stalls selling wildlife.\n\nThere's actually no data to support the claim, and the data provided by the China-@WHO joint study, whether you trust it or not, contradicts the claim.", 'location': 'California'}, {'author_id': 127997053, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1476722269766492163, 'original_text': 'Por favor cuídate del covid y no beses a nadie que no sea yo el viernes', 'location': None}, {'author_id': 1321873703785930754, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1476722269720305664, 'original_text': 'BREAKING: Florida mayor Jerry Demmings blasts Governor DeSantis, accuses him of cowering and hiding as his reckless COVID policies backfire and the Omicron variant ravages the state, asking, “Where is Ron DeSantis now!?” RT TO THANK MAYOR DEMMINGS FOR CALLING DEATHSANTIS OUT!', 'location': 'Eastern NC'}, {'author_id': 1056811681899257857, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1476722269627899906, 'original_text': 'Follow The Science? Twitter Suspends mRNA Vaccine Inventor Dr. Robert Malone Who Questioned COVID Jab https://t.co/EOuda8tNja via @redvoicemedias', 'location': 'White Rabbit St, MATRIX '}, {'author_id': 759804041459273728, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1476722269464498178, 'original_text': "@Nanookbn @RLurieCTV good news for us, we aren't getting sick, it's all of you who took the experimental that are super spreaders now. How does it feel to have risked your life, lost your freedoms and visitors prohibited and curfew.  Nothing changed but your health!", 'location': 'Montréal, Québec'}, {'author_id': 218854536, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1476722269346877441, 'original_text': 'JUST IN\n\nThe group behind the #Lawan series of protests are suing the govt and police for alleged violations of fundamental liberties during a Covi ... (7 characters truncated) ... ndlelight vigil held earlier this year.\n\nIn August, 30 people were hauled up and compounded for participating in the event. https://t.co/gRQqgsxZPZ', 'location': 'malaysia'}, {'author_id': 1135956772282413056, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1476722269288337415, 'original_text': 'Un día más sin pillar el covid.\nUn día menos para pillarlo.', 'location': 'Islas Canarias'}, {'author_id': 987480088961691648, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1476722269246263296, 'original_text': '"The Amarillo Public Health Department reported  17 new deaths in Wednesday\'s COVID-19 report card." This is what happens when your Congressman spews disinformation about the effectiveness of vaccinations and masks. @RonnyJacksonTX', 'location': None}, {'author_id': 1450632043, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1476722269179154435, 'original_text': 'The U.S. just reported 484,377 new covid cases, the world record for the whole pandemic. And our government’s response is to get people back to work.', 'location': 'amor fati'}, {'author_id': 1307340897680584705, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1476722269166710787, 'original_text': '#EnVideo📹| COVID-19 | Venezuela registró 200 casos comunitarios, 3 importados y 433.208 pacientes recuperados\n\n#AbrazaLaVida \n\nhttps://t.co/tXRZTmdeGh', 'location': None})]
(Background on this error at: http://sqlalche.me/e/13/9h9h)
[2022-01-05 06:00:48,133] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=load_dimensions, task_id=tweet_load, execution_date=20211231T010000, start_date=20220105T060046, end_date=20220105T060048
[2022-01-05 06:00:48,146] {standard_task_runner.py:92} ERROR - Failed to execute job 162 for task tweet_load
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
psycopg2.errors.NumericValueOutOfRange: numeric value "1284477302223634433" out of range for integer


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/load_redshift.py", line 133, in load_tweets
    tweet_data.to_sql('tweet', redshift_hook.get_sqlalchemy_engine(), if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1350, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 882, in _execute_insert
    conn.execute(self.table.insert(), data)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1011, in execute
    return meth(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 298, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1130, in _execute_clauseelement
    distilled_params,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1317, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1511, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (psycopg2.errors.NumericValueOutOfRange) numeric value "1284477302223634433" out of range for integer

[SQL: INSERT INTO tweet (author_id, created_at, id, original_text, location) VALUES (%(author_id)s, %(created_at)s, %(id)s, %(original_text)s, %(location)s)]
[parameters: ({'author_id': 1284477302223634433, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1476722269833633800, 'original_text': "One common #OriginOfCovid misunderstanding is that early Covid-19 cases were linked to market stalls selling wildlife.\n\nThere's actually no data to support the claim, and the data provided by the China-@WHO joint study, whether you trust it or not, contradicts the claim.", 'location': 'California'}, {'author_id': 127997053, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1476722269766492163, 'original_text': 'Por favor cuídate del covid y no beses a nadie que no sea yo el viernes', 'location': None}, {'author_id': 1321873703785930754, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1476722269720305664, 'original_text': 'BREAKING: Florida mayor Jerry Demmings blasts Governor DeSantis, accuses him of cowering and hiding as his reckless COVID policies backfire and the Omicron variant ravages the state, asking, “Where is Ron DeSantis now!?” RT TO THANK MAYOR DEMMINGS FOR CALLING DEATHSANTIS OUT!', 'location': 'Eastern NC'}, {'author_id': 1056811681899257857, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1476722269627899906, 'original_text': 'Follow The Science? Twitter Suspends mRNA Vaccine Inventor Dr. Robert Malone Who Questioned COVID Jab https://t.co/EOuda8tNja via @redvoicemedias', 'location': 'White Rabbit St, MATRIX '}, {'author_id': 759804041459273728, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1476722269464498178, 'original_text': "@Nanookbn @RLurieCTV good news for us, we aren't getting sick, it's all of you who took the experimental that are super spreaders now. How does it feel to have risked your life, lost your freedoms and visitors prohibited and curfew.  Nothing changed but your health!", 'location': 'Montréal, Québec'}, {'author_id': 218854536, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1476722269346877441, 'original_text': 'JUST IN\n\nThe group behind the #Lawan series of protests are suing the govt and police for alleged violations of fundamental liberties during a Covi ... (7 characters truncated) ... ndlelight vigil held earlier this year.\n\nIn August, 30 people were hauled up and compounded for participating in the event. https://t.co/gRQqgsxZPZ', 'location': 'malaysia'}, {'author_id': 1135956772282413056, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1476722269288337415, 'original_text': 'Un día más sin pillar el covid.\nUn día menos para pillarlo.', 'location': 'Islas Canarias'}, {'author_id': 987480088961691648, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1476722269246263296, 'original_text': '"The Amarillo Public Health Department reported  17 new deaths in Wednesday\'s COVID-19 report card." This is what happens when your Congressman spews disinformation about the effectiveness of vaccinations and masks. @RonnyJacksonTX', 'location': None}, {'author_id': 1450632043, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1476722269179154435, 'original_text': 'The U.S. just reported 484,377 new covid cases, the world record for the whole pandemic. And our government’s response is to get people back to work.', 'location': 'amor fati'}, {'author_id': 1307340897680584705, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1476722269166710787, 'original_text': '#EnVideo📹| COVID-19 | Venezuela registró 200 casos comunitarios, 3 importados y 433.208 pacientes recuperados\n\n#AbrazaLaVida \n\nhttps://t.co/tXRZTmdeGh', 'location': None})]
(Background on this error at: http://sqlalche.me/e/13/9h9h)
[2022-01-05 06:00:48,157] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-05 06:00:48,188] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-05 06:01:47,929] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 06:01:47,947] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 06:01:47,947] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 06:01:47,948] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-05 06:01:47,948] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 06:01:47,973] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): tweet_load> on 2021-12-31 01:00:00+00:00
[2022-01-05 06:01:47,983] {standard_task_runner.py:52} INFO - Started process 1598 to run task
[2022-01-05 06:01:47,994] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'load_dimensions', 'tweet_load', 'scheduled__2021-12-31T01:00:00+00:00', '--job-id', '178', '--raw', '--subdir', 'DAGS_FOLDER/load_redshift.py', '--cfg-path', '/tmp/tmpymztlj2s', '--error-file', '/tmp/tmpg_9v493g']
[2022-01-05 06:01:47,995] {standard_task_runner.py:77} INFO - Job 178: Subtask tweet_load
[2022-01-05 06:01:48,121] {logging_mixin.py:109} INFO - Running <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]> on host 2b1d65872a35
[2022-01-05 06:01:48,187] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=test_owner
AIRFLOW_CTX_DAG_ID=load_dimensions
AIRFLOW_CTX_TASK_ID=tweet_load
AIRFLOW_CTX_EXECUTION_DATE=2021-12-31T01:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-12-31T01:00:00+00:00
[2022-01-05 06:01:48,188] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:01:48,188] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:01:48,188] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:01:48,189] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:01:48,189] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:01:48,189] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:01:48,189] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:01:48,189] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:01:48,189] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:01:48,189] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:01:48,190] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:01:48,190] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:01:48,190] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7fd8b40b1950>, 'dag': <DAG: load_dimensions>, 'dag_run': <DagRun load_dimensions @ 2021-12-31 01:00:00+00:00: scheduled__2021-12-31T01:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2021-12-31', 'ds_nodash': '20211231', 'execution_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2021-12-31', 'next_ds_nodash': '20211231', 'next_execution_date': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': DateTime(2021, 12, 31, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2021-12-31T01:00:00+00:00', 'task': <Task(PythonOperator): tweet_load>, 'task_instance': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'task_instance_key_str': 'load_dimensions__tweet_load__20211231', 'test_mode': False, 'ti': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-01', 'tomorrow_ds_nodash': '20220101', 'ts': '2021-12-31T01:00:00+00:00', 'ts_nodash': '20211231T010000', 'ts_nodash_with_tz': '20211231T010000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-30', 'yesterday_ds_nodash': '20211230', 'key': 'value', 'ts_var': '2021-12-31T01:00:00+00:00', 'tsnodash_var': '20211231T010000', 'templates_dict': None}
[2022-01-05 06:01:48,190] {logging_mixin.py:109} INFO - Hello, Current Time:06:01:48 Execution time is 2021-12-31T01:00:00+00:00
[2022-01-05 06:01:48,206] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 06:01:48,214] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 06:01:49,573] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
psycopg2.errors.NumericValueOutOfRange: numeric value "1284477302223634433" out of range for integer


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/load_redshift.py", line 133, in load_tweets
    tweet_data.to_sql('tweet', redshift_hook.get_sqlalchemy_engine(), if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1350, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 882, in _execute_insert
    conn.execute(self.table.insert(), data)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1011, in execute
    return meth(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 298, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1130, in _execute_clauseelement
    distilled_params,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1317, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1511, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (psycopg2.errors.NumericValueOutOfRange) numeric value "1284477302223634433" out of range for integer

[SQL: INSERT INTO tweet (id, created_at, author_id, original_text, location) VALUES (%(id)s, %(created_at)s, %(author_id)s, %(original_text)s, %(location)s)]
[parameters: ({'id': 1476722269833633800, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1284477302223634433, 'original_text': "One common #OriginOfCovid misunderstanding is that early Covid-19 cases were linked to market stalls selling wildlife.\n\nThere's actually no data to support the claim, and the data provided by the China-@WHO joint study, whether you trust it or not, contradicts the claim.", 'location': 'California'}, {'id': 1476722269766492163, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 127997053, 'original_text': 'Por favor cuídate del covid y no beses a nadie que no sea yo el viernes', 'location': None}, {'id': 1476722269720305664, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1321873703785930754, 'original_text': 'BREAKING: Florida mayor Jerry Demmings blasts Governor DeSantis, accuses him of cowering and hiding as his reckless COVID policies backfire and the Omicron variant ravages the state, asking, “Where is Ron DeSantis now!?” RT TO THANK MAYOR DEMMINGS FOR CALLING DEATHSANTIS OUT!', 'location': 'Eastern NC'}, {'id': 1476722269627899906, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1056811681899257857, 'original_text': 'Follow The Science? Twitter Suspends mRNA Vaccine Inventor Dr. Robert Malone Who Questioned COVID Jab https://t.co/EOuda8tNja via @redvoicemedias', 'location': 'White Rabbit St, MATRIX '}, {'id': 1476722269464498178, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 759804041459273728, 'original_text': "@Nanookbn @RLurieCTV good news for us, we aren't getting sick, it's all of you who took the experimental that are super spreaders now. How does it feel to have risked your life, lost your freedoms and visitors prohibited and curfew.  Nothing changed but your health!", 'location': 'Montréal, Québec'}, {'id': 1476722269346877441, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 218854536, 'original_text': 'JUST IN\n\nThe group behind the #Lawan series of protests are suing the govt and police for alleged violations of fundamental liberties during a Covi ... (7 characters truncated) ... ndlelight vigil held earlier this year.\n\nIn August, 30 people were hauled up and compounded for participating in the event. https://t.co/gRQqgsxZPZ', 'location': 'malaysia'}, {'id': 1476722269288337415, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1135956772282413056, 'original_text': 'Un día más sin pillar el covid.\nUn día menos para pillarlo.', 'location': 'Islas Canarias'}, {'id': 1476722269246263296, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 987480088961691648, 'original_text': '"The Amarillo Public Health Department reported  17 new deaths in Wednesday\'s COVID-19 report card." This is what happens when your Congressman spews disinformation about the effectiveness of vaccinations and masks. @RonnyJacksonTX', 'location': None}, {'id': 1476722269179154435, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1450632043, 'original_text': 'The U.S. just reported 484,377 new covid cases, the world record for the whole pandemic. And our government’s response is to get people back to work.', 'location': 'amor fati'}, {'id': 1476722269166710787, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1307340897680584705, 'original_text': '#EnVideo📹| COVID-19 | Venezuela registró 200 casos comunitarios, 3 importados y 433.208 pacientes recuperados\n\n#AbrazaLaVida \n\nhttps://t.co/tXRZTmdeGh', 'location': None})]
(Background on this error at: http://sqlalche.me/e/13/9h9h)
[2022-01-05 06:01:49,594] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=load_dimensions, task_id=tweet_load, execution_date=20211231T010000, start_date=20220105T060147, end_date=20220105T060149
[2022-01-05 06:01:49,611] {standard_task_runner.py:92} ERROR - Failed to execute job 178 for task tweet_load
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
psycopg2.errors.NumericValueOutOfRange: numeric value "1284477302223634433" out of range for integer


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/load_redshift.py", line 133, in load_tweets
    tweet_data.to_sql('tweet', redshift_hook.get_sqlalchemy_engine(), if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1350, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 882, in _execute_insert
    conn.execute(self.table.insert(), data)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1011, in execute
    return meth(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 298, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1130, in _execute_clauseelement
    distilled_params,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1317, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1511, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (psycopg2.errors.NumericValueOutOfRange) numeric value "1284477302223634433" out of range for integer

[SQL: INSERT INTO tweet (id, created_at, author_id, original_text, location) VALUES (%(id)s, %(created_at)s, %(author_id)s, %(original_text)s, %(location)s)]
[parameters: ({'id': 1476722269833633800, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1284477302223634433, 'original_text': "One common #OriginOfCovid misunderstanding is that early Covid-19 cases were linked to market stalls selling wildlife.\n\nThere's actually no data to support the claim, and the data provided by the China-@WHO joint study, whether you trust it or not, contradicts the claim.", 'location': 'California'}, {'id': 1476722269766492163, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 127997053, 'original_text': 'Por favor cuídate del covid y no beses a nadie que no sea yo el viernes', 'location': None}, {'id': 1476722269720305664, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1321873703785930754, 'original_text': 'BREAKING: Florida mayor Jerry Demmings blasts Governor DeSantis, accuses him of cowering and hiding as his reckless COVID policies backfire and the Omicron variant ravages the state, asking, “Where is Ron DeSantis now!?” RT TO THANK MAYOR DEMMINGS FOR CALLING DEATHSANTIS OUT!', 'location': 'Eastern NC'}, {'id': 1476722269627899906, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1056811681899257857, 'original_text': 'Follow The Science? Twitter Suspends mRNA Vaccine Inventor Dr. Robert Malone Who Questioned COVID Jab https://t.co/EOuda8tNja via @redvoicemedias', 'location': 'White Rabbit St, MATRIX '}, {'id': 1476722269464498178, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 759804041459273728, 'original_text': "@Nanookbn @RLurieCTV good news for us, we aren't getting sick, it's all of you who took the experimental that are super spreaders now. How does it feel to have risked your life, lost your freedoms and visitors prohibited and curfew.  Nothing changed but your health!", 'location': 'Montréal, Québec'}, {'id': 1476722269346877441, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 218854536, 'original_text': 'JUST IN\n\nThe group behind the #Lawan series of protests are suing the govt and police for alleged violations of fundamental liberties during a Covi ... (7 characters truncated) ... ndlelight vigil held earlier this year.\n\nIn August, 30 people were hauled up and compounded for participating in the event. https://t.co/gRQqgsxZPZ', 'location': 'malaysia'}, {'id': 1476722269288337415, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1135956772282413056, 'original_text': 'Un día más sin pillar el covid.\nUn día menos para pillarlo.', 'location': 'Islas Canarias'}, {'id': 1476722269246263296, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 987480088961691648, 'original_text': '"The Amarillo Public Health Department reported  17 new deaths in Wednesday\'s COVID-19 report card." This is what happens when your Congressman spews disinformation about the effectiveness of vaccinations and masks. @RonnyJacksonTX', 'location': None}, {'id': 1476722269179154435, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1450632043, 'original_text': 'The U.S. just reported 484,377 new covid cases, the world record for the whole pandemic. And our government’s response is to get people back to work.', 'location': 'amor fati'}, {'id': 1476722269166710787, 'created_at': '2021-12-31T01:09:59.000Z', 'author_id': 1307340897680584705, 'original_text': '#EnVideo📹| COVID-19 | Venezuela registró 200 casos comunitarios, 3 importados y 433.208 pacientes recuperados\n\n#AbrazaLaVida \n\nhttps://t.co/tXRZTmdeGh', 'location': None})]
(Background on this error at: http://sqlalche.me/e/13/9h9h)
[2022-01-05 06:01:49,653] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-05 06:01:49,694] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-05 06:06:14,068] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 06:06:14,095] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 06:06:14,096] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 06:06:14,096] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-05 06:06:14,096] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 06:06:14,133] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): tweet_load> on 2021-12-31 01:00:00+00:00
[2022-01-05 06:06:14,143] {standard_task_runner.py:52} INFO - Started process 1857 to run task
[2022-01-05 06:06:14,158] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'load_dimensions', 'tweet_load', 'scheduled__2021-12-31T01:00:00+00:00', '--job-id', '195', '--raw', '--subdir', 'DAGS_FOLDER/load_redshift.py', '--cfg-path', '/tmp/tmpv4i5gxro', '--error-file', '/tmp/tmp9f0dss61']
[2022-01-05 06:06:14,159] {standard_task_runner.py:77} INFO - Job 195: Subtask tweet_load
[2022-01-05 06:06:14,374] {logging_mixin.py:109} INFO - Running <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]> on host 2b1d65872a35
[2022-01-05 06:06:14,549] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=test_owner
AIRFLOW_CTX_DAG_ID=load_dimensions
AIRFLOW_CTX_TASK_ID=tweet_load
AIRFLOW_CTX_EXECUTION_DATE=2021-12-31T01:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-12-31T01:00:00+00:00
[2022-01-05 06:06:14,550] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:06:14,551] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:06:14,551] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:06:14,551] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:06:14,551] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:06:14,551] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:06:14,552] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:06:14,552] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:06:14,552] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:06:14,552] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:06:14,552] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:06:14,552] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:06:14,553] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7fd8b40b1950>, 'dag': <DAG: load_dimensions>, 'dag_run': <DagRun load_dimensions @ 2021-12-31 01:00:00+00:00: scheduled__2021-12-31T01:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2021-12-31', 'ds_nodash': '20211231', 'execution_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2021-12-31', 'next_ds_nodash': '20211231', 'next_execution_date': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': DateTime(2021, 12, 31, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2021-12-31T01:00:00+00:00', 'task': <Task(PythonOperator): tweet_load>, 'task_instance': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'task_instance_key_str': 'load_dimensions__tweet_load__20211231', 'test_mode': False, 'ti': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-01', 'tomorrow_ds_nodash': '20220101', 'ts': '2021-12-31T01:00:00+00:00', 'ts_nodash': '20211231T010000', 'ts_nodash_with_tz': '20211231T010000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-30', 'yesterday_ds_nodash': '20211230', 'key': 'value', 'ts_var': '2021-12-31T01:00:00+00:00', 'tsnodash_var': '20211231T010000', 'templates_dict': None}
[2022-01-05 06:06:14,553] {logging_mixin.py:109} INFO - Hello, Current Time:06:06:14 Execution time is 2021-12-31T01:00:00+00:00
[2022-01-05 06:06:14,612] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 06:06:14,645] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 06:06:16,094] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
psycopg2.errors.StringDataRightTruncation: value too long for type character varying(200)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/load_redshift.py", line 136, in load_tweets
    tweet_data.to_sql('tweet', redshift_hook.get_sqlalchemy_engine(), if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1350, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 882, in _execute_insert
    conn.execute(self.table.insert(), data)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1011, in execute
    return meth(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 298, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1130, in _execute_clauseelement
    distilled_params,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1317, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1511, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(200)

[SQL: INSERT INTO tweet (author_id, created_at, id, original_text, location) VALUES (%(author_id)s, %(created_at)s, %(id)s, %(original_text)s, %(location)s)]
[parameters: ({'author_id': 1284477302223634433, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1284477302223634433, 'original_text': "One common #OriginOfCovid misunderstanding is that early Covid-19 cases were linked to market stalls selling wildlife.\n\nThere's actually no data to support the claim, and the data provided by the China-@WHO joint study, whether you trust it or not, contradicts the claim.", 'location': 'California'}, {'author_id': 127997053, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 127997053, 'original_text': 'Por favor cuídate del covid y no beses a nadie que no sea yo el viernes', 'location': None}, {'author_id': 1321873703785930754, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1321873703785930754, 'original_text': 'BREAKING: Florida mayor Jerry Demmings blasts Governor DeSantis, accuses him of cowering and hiding as his reckless COVID policies backfire and the Omicron variant ravages the state, asking, “Where is Ron DeSantis now!?” RT TO THANK MAYOR DEMMINGS FOR CALLING DEATHSANTIS OUT!', 'location': 'Eastern NC'}, {'author_id': 1056811681899257857, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1056811681899257857, 'original_text': 'Follow The Science? Twitter Suspends mRNA Vaccine Inventor Dr. Robert Malone Who Questioned COVID Jab https://t.co/EOuda8tNja via @redvoicemedias', 'location': 'White Rabbit St, MATRIX '}, {'author_id': 759804041459273728, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 759804041459273728, 'original_text': "@Nanookbn @RLurieCTV good news for us, we aren't getting sick, it's all of you who took the experimental that are super spreaders now. How does it feel to have risked your life, lost your freedoms and visitors prohibited and curfew.  Nothing changed but your health!", 'location': 'Montréal, Québec'}, {'author_id': 218854536, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 218854536, 'original_text': 'JUST IN\n\nThe group behind the #Lawan series of protests are suing the govt and police for alleged violations of fundamental liberties during a Covi ... (7 characters truncated) ... ndlelight vigil held earlier this year.\n\nIn August, 30 people were hauled up and compounded for participating in the event. https://t.co/gRQqgsxZPZ', 'location': 'malaysia'}, {'author_id': 1135956772282413056, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1135956772282413056, 'original_text': 'Un día más sin pillar el covid.\nUn día menos para pillarlo.', 'location': 'Islas Canarias'}, {'author_id': 987480088961691648, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 987480088961691648, 'original_text': '"The Amarillo Public Health Department reported  17 new deaths in Wednesday\'s COVID-19 report card." This is what happens when your Congressman spews disinformation about the effectiveness of vaccinations and masks. @RonnyJacksonTX', 'location': None}, {'author_id': 1450632043, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1450632043, 'original_text': 'The U.S. just reported 484,377 new covid cases, the world record for the whole pandemic. And our government’s response is to get people back to work.', 'location': 'amor fati'}, {'author_id': 1307340897680584705, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1307340897680584705, 'original_text': '#EnVideo📹| COVID-19 | Venezuela registró 200 casos comunitarios, 3 importados y 433.208 pacientes recuperados\n\n#AbrazaLaVida \n\nhttps://t.co/tXRZTmdeGh', 'location': None})]
(Background on this error at: http://sqlalche.me/e/13/9h9h)
[2022-01-05 06:06:16,111] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=load_dimensions, task_id=tweet_load, execution_date=20211231T010000, start_date=20220105T060614, end_date=20220105T060616
[2022-01-05 06:06:16,126] {standard_task_runner.py:92} ERROR - Failed to execute job 195 for task tweet_load
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
psycopg2.errors.StringDataRightTruncation: value too long for type character varying(200)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/load_redshift.py", line 136, in load_tweets
    tweet_data.to_sql('tweet', redshift_hook.get_sqlalchemy_engine(), if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1350, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 882, in _execute_insert
    conn.execute(self.table.insert(), data)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1011, in execute
    return meth(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 298, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1130, in _execute_clauseelement
    distilled_params,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1317, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1511, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(200)

[SQL: INSERT INTO tweet (author_id, created_at, id, original_text, location) VALUES (%(author_id)s, %(created_at)s, %(id)s, %(original_text)s, %(location)s)]
[parameters: ({'author_id': 1284477302223634433, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1284477302223634433, 'original_text': "One common #OriginOfCovid misunderstanding is that early Covid-19 cases were linked to market stalls selling wildlife.\n\nThere's actually no data to support the claim, and the data provided by the China-@WHO joint study, whether you trust it or not, contradicts the claim.", 'location': 'California'}, {'author_id': 127997053, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 127997053, 'original_text': 'Por favor cuídate del covid y no beses a nadie que no sea yo el viernes', 'location': None}, {'author_id': 1321873703785930754, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1321873703785930754, 'original_text': 'BREAKING: Florida mayor Jerry Demmings blasts Governor DeSantis, accuses him of cowering and hiding as his reckless COVID policies backfire and the Omicron variant ravages the state, asking, “Where is Ron DeSantis now!?” RT TO THANK MAYOR DEMMINGS FOR CALLING DEATHSANTIS OUT!', 'location': 'Eastern NC'}, {'author_id': 1056811681899257857, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1056811681899257857, 'original_text': 'Follow The Science? Twitter Suspends mRNA Vaccine Inventor Dr. Robert Malone Who Questioned COVID Jab https://t.co/EOuda8tNja via @redvoicemedias', 'location': 'White Rabbit St, MATRIX '}, {'author_id': 759804041459273728, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 759804041459273728, 'original_text': "@Nanookbn @RLurieCTV good news for us, we aren't getting sick, it's all of you who took the experimental that are super spreaders now. How does it feel to have risked your life, lost your freedoms and visitors prohibited and curfew.  Nothing changed but your health!", 'location': 'Montréal, Québec'}, {'author_id': 218854536, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 218854536, 'original_text': 'JUST IN\n\nThe group behind the #Lawan series of protests are suing the govt and police for alleged violations of fundamental liberties during a Covi ... (7 characters truncated) ... ndlelight vigil held earlier this year.\n\nIn August, 30 people were hauled up and compounded for participating in the event. https://t.co/gRQqgsxZPZ', 'location': 'malaysia'}, {'author_id': 1135956772282413056, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1135956772282413056, 'original_text': 'Un día más sin pillar el covid.\nUn día menos para pillarlo.', 'location': 'Islas Canarias'}, {'author_id': 987480088961691648, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 987480088961691648, 'original_text': '"The Amarillo Public Health Department reported  17 new deaths in Wednesday\'s COVID-19 report card." This is what happens when your Congressman spews disinformation about the effectiveness of vaccinations and masks. @RonnyJacksonTX', 'location': None}, {'author_id': 1450632043, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1450632043, 'original_text': 'The U.S. just reported 484,377 new covid cases, the world record for the whole pandemic. And our government’s response is to get people back to work.', 'location': 'amor fati'}, {'author_id': 1307340897680584705, 'created_at': '2021-12-31T01:09:59.000Z', 'id': 1307340897680584705, 'original_text': '#EnVideo📹| COVID-19 | Venezuela registró 200 casos comunitarios, 3 importados y 433.208 pacientes recuperados\n\n#AbrazaLaVida \n\nhttps://t.co/tXRZTmdeGh', 'location': None})]
(Background on this error at: http://sqlalche.me/e/13/9h9h)
[2022-01-05 06:06:16,142] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-05 06:06:16,179] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-05 06:09:21,694] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 06:09:21,729] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 06:09:21,730] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 06:09:21,730] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-05 06:09:21,730] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 06:09:21,759] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): tweet_load> on 2021-12-31 01:00:00+00:00
[2022-01-05 06:09:21,771] {standard_task_runner.py:52} INFO - Started process 2056 to run task
[2022-01-05 06:09:21,776] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'load_dimensions', 'tweet_load', 'scheduled__2021-12-31T01:00:00+00:00', '--job-id', '214', '--raw', '--subdir', 'DAGS_FOLDER/load_redshift.py', '--cfg-path', '/tmp/tmpanfav0x6', '--error-file', '/tmp/tmpfqn3g_uy']
[2022-01-05 06:09:21,778] {standard_task_runner.py:77} INFO - Job 214: Subtask tweet_load
[2022-01-05 06:09:21,934] {logging_mixin.py:109} INFO - Running <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]> on host 2b1d65872a35
[2022-01-05 06:09:22,027] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=test_owner
AIRFLOW_CTX_DAG_ID=load_dimensions
AIRFLOW_CTX_TASK_ID=tweet_load
AIRFLOW_CTX_EXECUTION_DATE=2021-12-31T01:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-12-31T01:00:00+00:00
[2022-01-05 06:09:22,029] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:09:22,030] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:09:22,030] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:09:22,030] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:09:22,030] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:09:22,030] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:09:22,030] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:09:22,030] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:09:22,031] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:09:22,031] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:09:22,031] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:09:22,031] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:09:22,031] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7fd8b40b1950>, 'dag': <DAG: load_dimensions>, 'dag_run': <DagRun load_dimensions @ 2021-12-31 01:00:00+00:00: scheduled__2021-12-31T01:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2021-12-31', 'ds_nodash': '20211231', 'execution_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2021-12-31', 'next_ds_nodash': '20211231', 'next_execution_date': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': DateTime(2021, 12, 31, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2021-12-31T01:00:00+00:00', 'task': <Task(PythonOperator): tweet_load>, 'task_instance': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'task_instance_key_str': 'load_dimensions__tweet_load__20211231', 'test_mode': False, 'ti': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-01', 'tomorrow_ds_nodash': '20220101', 'ts': '2021-12-31T01:00:00+00:00', 'ts_nodash': '20211231T010000', 'ts_nodash_with_tz': '20211231T010000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-30', 'yesterday_ds_nodash': '20211230', 'key': 'value', 'ts_var': '2021-12-31T01:00:00+00:00', 'tsnodash_var': '20211231T010000', 'templates_dict': None}
[2022-01-05 06:09:22,031] {logging_mixin.py:109} INFO - Hello, Current Time:06:09:22 Execution time is 2021-12-31T01:00:00+00:00
[2022-01-05 06:09:22,051] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 06:09:22,059] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 06:09:23,765] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
psycopg2.errors.StringDataRightTruncation: value too long for type character varying(256)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/load_redshift.py", line 136, in load_tweets
    tweet_data.to_sql('tweet', redshift_hook.get_sqlalchemy_engine(), if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1350, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 882, in _execute_insert
    conn.execute(self.table.insert(), data)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1011, in execute
    return meth(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 298, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1130, in _execute_clauseelement
    distilled_params,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1317, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1511, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(256)

[SQL: INSERT INTO tweet (created_at, id, author_id, original_text, location) VALUES (%(created_at)s, %(id)s, %(author_id)s, %(original_text)s, %(location)s)]
[parameters: ({'created_at': '2021-12-31T01:09:59.000Z', 'id': 1284477302223634433, 'author_id': 1284477302223634433, 'original_text': "One common #OriginOfCovid misunderstanding is that early Covid-19 cases were linked to market stalls selling wildlife.\n\nThere's actually no data to support the claim, and the data provided by the China-@WHO joint study, whether you trust it or not, contradicts the claim.", 'location': 'California'}, {'created_at': '2021-12-31T01:09:59.000Z', 'id': 127997053, 'author_id': 127997053, 'original_text': 'Por favor cuídate del covid y no beses a nadie que no sea yo el viernes', 'location': None}, {'created_at': '2021-12-31T01:09:59.000Z', 'id': 1321873703785930754, 'author_id': 1321873703785930754, 'original_text': 'BREAKING: Florida mayor Jerry Demmings blasts Governor DeSantis, accuses him of cowering and hiding as his reckless COVID policies backfire and the Omicron variant ravages the state, asking, “Where is Ron DeSantis now!?” RT TO THANK MAYOR DEMMINGS FOR CALLING DEATHSANTIS OUT!', 'location': 'Eastern NC'}, {'created_at': '2021-12-31T01:09:59.000Z', 'id': 1056811681899257857, 'author_id': 1056811681899257857, 'original_text': 'Follow The Science? Twitter Suspends mRNA Vaccine Inventor Dr. Robert Malone Who Questioned COVID Jab https://t.co/EOuda8tNja via @redvoicemedias', 'location': 'White Rabbit St, MATRIX '}, {'created_at': '2021-12-31T01:09:59.000Z', 'id': 759804041459273728, 'author_id': 759804041459273728, 'original_text': "@Nanookbn @RLurieCTV good news for us, we aren't getting sick, it's all of you who took the experimental that are super spreaders now. How does it feel to have risked your life, lost your freedoms and visitors prohibited and curfew.  Nothing changed but your health!", 'location': 'Montréal, Québec'}, {'created_at': '2021-12-31T01:09:59.000Z', 'id': 218854536, 'author_id': 218854536, 'original_text': 'JUST IN\n\nThe group behind the #Lawan series of protests are suing the govt and police for alleged violations of fundamental liberties during a Covi ... (7 characters truncated) ... ndlelight vigil held earlier this year.\n\nIn August, 30 people were hauled up and compounded for participating in the event. https://t.co/gRQqgsxZPZ', 'location': 'malaysia'}, {'created_at': '2021-12-31T01:09:59.000Z', 'id': 1135956772282413056, 'author_id': 1135956772282413056, 'original_text': 'Un día más sin pillar el covid.\nUn día menos para pillarlo.', 'location': 'Islas Canarias'}, {'created_at': '2021-12-31T01:09:59.000Z', 'id': 987480088961691648, 'author_id': 987480088961691648, 'original_text': '"The Amarillo Public Health Department reported  17 new deaths in Wednesday\'s COVID-19 report card." This is what happens when your Congressman spews disinformation about the effectiveness of vaccinations and masks. @RonnyJacksonTX', 'location': None}, {'created_at': '2021-12-31T01:09:59.000Z', 'id': 1450632043, 'author_id': 1450632043, 'original_text': 'The U.S. just reported 484,377 new covid cases, the world record for the whole pandemic. And our government’s response is to get people back to work.', 'location': 'amor fati'}, {'created_at': '2021-12-31T01:09:59.000Z', 'id': 1307340897680584705, 'author_id': 1307340897680584705, 'original_text': '#EnVideo📹| COVID-19 | Venezuela registró 200 casos comunitarios, 3 importados y 433.208 pacientes recuperados\n\n#AbrazaLaVida \n\nhttps://t.co/tXRZTmdeGh', 'location': None})]
(Background on this error at: http://sqlalche.me/e/13/9h9h)
[2022-01-05 06:09:23,789] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=load_dimensions, task_id=tweet_load, execution_date=20211231T010000, start_date=20220105T060921, end_date=20220105T060923
[2022-01-05 06:09:23,812] {standard_task_runner.py:92} ERROR - Failed to execute job 214 for task tweet_load
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
psycopg2.errors.StringDataRightTruncation: value too long for type character varying(256)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/load_redshift.py", line 136, in load_tweets
    tweet_data.to_sql('tweet', redshift_hook.get_sqlalchemy_engine(), if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1350, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 882, in _execute_insert
    conn.execute(self.table.insert(), data)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1011, in execute
    return meth(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 298, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1130, in _execute_clauseelement
    distilled_params,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1317, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1511, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(256)

[SQL: INSERT INTO tweet (created_at, id, author_id, original_text, location) VALUES (%(created_at)s, %(id)s, %(author_id)s, %(original_text)s, %(location)s)]
[parameters: ({'created_at': '2021-12-31T01:09:59.000Z', 'id': 1284477302223634433, 'author_id': 1284477302223634433, 'original_text': "One common #OriginOfCovid misunderstanding is that early Covid-19 cases were linked to market stalls selling wildlife.\n\nThere's actually no data to support the claim, and the data provided by the China-@WHO joint study, whether you trust it or not, contradicts the claim.", 'location': 'California'}, {'created_at': '2021-12-31T01:09:59.000Z', 'id': 127997053, 'author_id': 127997053, 'original_text': 'Por favor cuídate del covid y no beses a nadie que no sea yo el viernes', 'location': None}, {'created_at': '2021-12-31T01:09:59.000Z', 'id': 1321873703785930754, 'author_id': 1321873703785930754, 'original_text': 'BREAKING: Florida mayor Jerry Demmings blasts Governor DeSantis, accuses him of cowering and hiding as his reckless COVID policies backfire and the Omicron variant ravages the state, asking, “Where is Ron DeSantis now!?” RT TO THANK MAYOR DEMMINGS FOR CALLING DEATHSANTIS OUT!', 'location': 'Eastern NC'}, {'created_at': '2021-12-31T01:09:59.000Z', 'id': 1056811681899257857, 'author_id': 1056811681899257857, 'original_text': 'Follow The Science? Twitter Suspends mRNA Vaccine Inventor Dr. Robert Malone Who Questioned COVID Jab https://t.co/EOuda8tNja via @redvoicemedias', 'location': 'White Rabbit St, MATRIX '}, {'created_at': '2021-12-31T01:09:59.000Z', 'id': 759804041459273728, 'author_id': 759804041459273728, 'original_text': "@Nanookbn @RLurieCTV good news for us, we aren't getting sick, it's all of you who took the experimental that are super spreaders now. How does it feel to have risked your life, lost your freedoms and visitors prohibited and curfew.  Nothing changed but your health!", 'location': 'Montréal, Québec'}, {'created_at': '2021-12-31T01:09:59.000Z', 'id': 218854536, 'author_id': 218854536, 'original_text': 'JUST IN\n\nThe group behind the #Lawan series of protests are suing the govt and police for alleged violations of fundamental liberties during a Covi ... (7 characters truncated) ... ndlelight vigil held earlier this year.\n\nIn August, 30 people were hauled up and compounded for participating in the event. https://t.co/gRQqgsxZPZ', 'location': 'malaysia'}, {'created_at': '2021-12-31T01:09:59.000Z', 'id': 1135956772282413056, 'author_id': 1135956772282413056, 'original_text': 'Un día más sin pillar el covid.\nUn día menos para pillarlo.', 'location': 'Islas Canarias'}, {'created_at': '2021-12-31T01:09:59.000Z', 'id': 987480088961691648, 'author_id': 987480088961691648, 'original_text': '"The Amarillo Public Health Department reported  17 new deaths in Wednesday\'s COVID-19 report card." This is what happens when your Congressman spews disinformation about the effectiveness of vaccinations and masks. @RonnyJacksonTX', 'location': None}, {'created_at': '2021-12-31T01:09:59.000Z', 'id': 1450632043, 'author_id': 1450632043, 'original_text': 'The U.S. just reported 484,377 new covid cases, the world record for the whole pandemic. And our government’s response is to get people back to work.', 'location': 'amor fati'}, {'created_at': '2021-12-31T01:09:59.000Z', 'id': 1307340897680584705, 'author_id': 1307340897680584705, 'original_text': '#EnVideo📹| COVID-19 | Venezuela registró 200 casos comunitarios, 3 importados y 433.208 pacientes recuperados\n\n#AbrazaLaVida \n\nhttps://t.co/tXRZTmdeGh', 'location': None})]
(Background on this error at: http://sqlalche.me/e/13/9h9h)
[2022-01-05 06:09:23,828] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-05 06:09:23,876] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-05 06:25:33,385] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 06:25:33,413] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 06:25:33,413] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 06:25:33,415] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-05 06:25:33,415] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 06:25:33,495] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): tweet_load> on 2021-12-31 01:00:00+00:00
[2022-01-05 06:25:33,506] {standard_task_runner.py:52} INFO - Started process 2824 to run task
[2022-01-05 06:25:33,523] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'load_dimensions', 'tweet_load', 'scheduled__2021-12-31T01:00:00+00:00', '--job-id', '232', '--raw', '--subdir', 'DAGS_FOLDER/load_redshift.py', '--cfg-path', '/tmp/tmp84e1vjky', '--error-file', '/tmp/tmpz2f084m8']
[2022-01-05 06:25:33,524] {standard_task_runner.py:77} INFO - Job 232: Subtask tweet_load
[2022-01-05 06:25:33,709] {logging_mixin.py:109} INFO - Running <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]> on host 2b1d65872a35
[2022-01-05 06:25:33,873] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=test_owner
AIRFLOW_CTX_DAG_ID=load_dimensions
AIRFLOW_CTX_TASK_ID=tweet_load
AIRFLOW_CTX_EXECUTION_DATE=2021-12-31T01:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-12-31T01:00:00+00:00
[2022-01-05 06:25:33,875] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:25:33,875] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:25:33,876] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:25:33,876] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:25:33,879] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:25:33,879] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:25:33,879] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:25:33,879] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:25:33,879] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:25:33,880] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:25:33,880] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:25:33,880] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:25:33,880] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7fd8b40b1950>, 'dag': <DAG: load_dimensions>, 'dag_run': <DagRun load_dimensions @ 2021-12-31 01:00:00+00:00: scheduled__2021-12-31T01:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2021-12-31', 'ds_nodash': '20211231', 'execution_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2021-12-31', 'next_ds_nodash': '20211231', 'next_execution_date': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': DateTime(2021, 12, 31, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2021-12-31T01:00:00+00:00', 'task': <Task(PythonOperator): tweet_load>, 'task_instance': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'task_instance_key_str': 'load_dimensions__tweet_load__20211231', 'test_mode': False, 'ti': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-01', 'tomorrow_ds_nodash': '20220101', 'ts': '2021-12-31T01:00:00+00:00', 'ts_nodash': '20211231T010000', 'ts_nodash_with_tz': '20211231T010000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-30', 'yesterday_ds_nodash': '20211230', 'key': 'value', 'ts_var': '2021-12-31T01:00:00+00:00', 'tsnodash_var': '20211231T010000', 'templates_dict': None}
[2022-01-05 06:25:33,880] {logging_mixin.py:109} INFO - Hello, Current Time:06:25:33 Execution time is 2021-12-31T01:00:00+00:00
[2022-01-05 06:25:33,902] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 06:25:33,932] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 06:25:35,307] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
psycopg2.errors.StringDataRightTruncation: value too long for type character varying(256)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/load_redshift.py", line 137, in load_tweets
    tweet_data.to_sql('tweet', redshift_hook.get_sqlalchemy_engine(), if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1350, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 882, in _execute_insert
    conn.execute(self.table.insert(), data)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1011, in execute
    return meth(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 298, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1130, in _execute_clauseelement
    distilled_params,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1317, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1511, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(256)

[SQL: INSERT INTO tweet (author_id, id, created_at, original_text, location) VALUES (%(author_id)s, %(id)s, %(created_at)s, %(original_text)s, %(location)s)]
[parameters: ({'author_id': 1284477302223634433, 'id': 1284477302223634433, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': "One common #OriginOfCovid misunderstanding is that early Covid-19 cases were linked to market stalls selling wildlife.\n\nThere's actually no data to support the claim, and the data provided by the China-@WHO joint study, whether you trust it or not, contradicts the claim.", 'location': 'California'}, {'author_id': 127997053, 'id': 127997053, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': 'Por favor cudate del covid y no beses a nadie que no sea yo el viernes', 'location': None}, {'author_id': 1321873703785930754, 'id': 1321873703785930754, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': 'BREAKING: Florida mayor Jerry Demmings blasts Governor DeSantis, accuses him of cowering and hiding as his reckless COVID policies backfire and the Omicron variant ravages the state, asking, Where is Ron DeSantis now!? RT TO THANK MAYOR DEMMINGS FOR CALLING DEATHSANTIS OUT!', 'location': 'Eastern NC'}, {'author_id': 1056811681899257857, 'id': 1056811681899257857, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': 'Follow The Science? Twitter Suspends mRNA Vaccine Inventor Dr. Robert Malone Who Questioned COVID Jab https://t.co/EOuda8tNja via @redvoicemedias', 'location': 'White Rabbit St, MATRIX '}, {'author_id': 759804041459273728, 'id': 759804041459273728, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': "@Nanookbn @RLurieCTV good news for us, we aren't getting sick, it's all of you who took the experimental that are super spreaders now. How does it feel to have risked your life, lost your freedoms and visitors prohibited and curfew.  Nothing changed but your health!", 'location': 'Montral, Qubec'}, {'author_id': 218854536, 'id': 218854536, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': 'JUST IN\n\nThe group behind the #Lawan series of protests are suing the govt and police for alleged violations of fundamental liberties during a Covi ... (7 characters truncated) ... ndlelight vigil held earlier this year.\n\nIn August, 30 people were hauled up and compounded for participating in the event. https://t.co/gRQqgsxZPZ', 'location': 'malaysia'}, {'author_id': 1135956772282413056, 'id': 1135956772282413056, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': 'Un da ms sin pillar el covid.\nUn da menos para pillarlo.', 'location': 'Islas Canarias'}, {'author_id': 987480088961691648, 'id': 987480088961691648, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': '"The Amarillo Public Health Department reported  17 new deaths in Wednesday\'s COVID-19 report card." This is what happens when your Congressman spews disinformation about the effectiveness of vaccinations and masks. @RonnyJacksonTX', 'location': None}, {'author_id': 1450632043, 'id': 1450632043, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': 'The U.S. just reported 484,377 new covid cases, the world record for the whole pandemic. And our governments response is to get people back to work.', 'location': 'amor fati'}, {'author_id': 1307340897680584705, 'id': 1307340897680584705, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': '#EnVideo| COVID-19 | Venezuela registr 200 casos comunitarios, 3 importados y 433.208 pacientes recuperados\n\n#AbrazaLaVida \n\nhttps://t.co/tXRZTmdeGh', 'location': None})]
(Background on this error at: http://sqlalche.me/e/13/9h9h)
[2022-01-05 06:25:35,326] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=load_dimensions, task_id=tweet_load, execution_date=20211231T010000, start_date=20220105T062533, end_date=20220105T062535
[2022-01-05 06:25:35,348] {standard_task_runner.py:92} ERROR - Failed to execute job 232 for task tweet_load
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
psycopg2.errors.StringDataRightTruncation: value too long for type character varying(256)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/load_redshift.py", line 137, in load_tweets
    tweet_data.to_sql('tweet', redshift_hook.get_sqlalchemy_engine(), if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1350, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 882, in _execute_insert
    conn.execute(self.table.insert(), data)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1011, in execute
    return meth(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 298, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1130, in _execute_clauseelement
    distilled_params,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1317, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1511, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(256)

[SQL: INSERT INTO tweet (author_id, id, created_at, original_text, location) VALUES (%(author_id)s, %(id)s, %(created_at)s, %(original_text)s, %(location)s)]
[parameters: ({'author_id': 1284477302223634433, 'id': 1284477302223634433, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': "One common #OriginOfCovid misunderstanding is that early Covid-19 cases were linked to market stalls selling wildlife.\n\nThere's actually no data to support the claim, and the data provided by the China-@WHO joint study, whether you trust it or not, contradicts the claim.", 'location': 'California'}, {'author_id': 127997053, 'id': 127997053, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': 'Por favor cudate del covid y no beses a nadie que no sea yo el viernes', 'location': None}, {'author_id': 1321873703785930754, 'id': 1321873703785930754, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': 'BREAKING: Florida mayor Jerry Demmings blasts Governor DeSantis, accuses him of cowering and hiding as his reckless COVID policies backfire and the Omicron variant ravages the state, asking, Where is Ron DeSantis now!? RT TO THANK MAYOR DEMMINGS FOR CALLING DEATHSANTIS OUT!', 'location': 'Eastern NC'}, {'author_id': 1056811681899257857, 'id': 1056811681899257857, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': 'Follow The Science? Twitter Suspends mRNA Vaccine Inventor Dr. Robert Malone Who Questioned COVID Jab https://t.co/EOuda8tNja via @redvoicemedias', 'location': 'White Rabbit St, MATRIX '}, {'author_id': 759804041459273728, 'id': 759804041459273728, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': "@Nanookbn @RLurieCTV good news for us, we aren't getting sick, it's all of you who took the experimental that are super spreaders now. How does it feel to have risked your life, lost your freedoms and visitors prohibited and curfew.  Nothing changed but your health!", 'location': 'Montral, Qubec'}, {'author_id': 218854536, 'id': 218854536, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': 'JUST IN\n\nThe group behind the #Lawan series of protests are suing the govt and police for alleged violations of fundamental liberties during a Covi ... (7 characters truncated) ... ndlelight vigil held earlier this year.\n\nIn August, 30 people were hauled up and compounded for participating in the event. https://t.co/gRQqgsxZPZ', 'location': 'malaysia'}, {'author_id': 1135956772282413056, 'id': 1135956772282413056, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': 'Un da ms sin pillar el covid.\nUn da menos para pillarlo.', 'location': 'Islas Canarias'}, {'author_id': 987480088961691648, 'id': 987480088961691648, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': '"The Amarillo Public Health Department reported  17 new deaths in Wednesday\'s COVID-19 report card." This is what happens when your Congressman spews disinformation about the effectiveness of vaccinations and masks. @RonnyJacksonTX', 'location': None}, {'author_id': 1450632043, 'id': 1450632043, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': 'The U.S. just reported 484,377 new covid cases, the world record for the whole pandemic. And our governments response is to get people back to work.', 'location': 'amor fati'}, {'author_id': 1307340897680584705, 'id': 1307340897680584705, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': '#EnVideo| COVID-19 | Venezuela registr 200 casos comunitarios, 3 importados y 433.208 pacientes recuperados\n\n#AbrazaLaVida \n\nhttps://t.co/tXRZTmdeGh', 'location': None})]
(Background on this error at: http://sqlalche.me/e/13/9h9h)
[2022-01-05 06:25:35,366] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-05 06:25:35,408] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-05 06:28:27,420] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 06:28:27,437] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 06:28:27,438] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 06:28:27,438] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-05 06:28:27,438] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 06:28:27,458] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): tweet_load> on 2021-12-31 01:00:00+00:00
[2022-01-05 06:28:27,465] {standard_task_runner.py:52} INFO - Started process 3003 to run task
[2022-01-05 06:28:27,470] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'load_dimensions', 'tweet_load', 'scheduled__2021-12-31T01:00:00+00:00', '--job-id', '249', '--raw', '--subdir', 'DAGS_FOLDER/load_redshift.py', '--cfg-path', '/tmp/tmpf14cdzjr', '--error-file', '/tmp/tmpezcnh2tb']
[2022-01-05 06:28:27,471] {standard_task_runner.py:77} INFO - Job 249: Subtask tweet_load
[2022-01-05 06:28:27,576] {logging_mixin.py:109} INFO - Running <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]> on host 2b1d65872a35
[2022-01-05 06:28:27,704] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=test_owner
AIRFLOW_CTX_DAG_ID=load_dimensions
AIRFLOW_CTX_TASK_ID=tweet_load
AIRFLOW_CTX_EXECUTION_DATE=2021-12-31T01:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-12-31T01:00:00+00:00
[2022-01-05 06:28:27,706] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:28:27,706] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:28:27,706] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:28:27,707] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:28:27,707] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:28:27,707] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:28:27,707] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:28:27,707] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:28:27,707] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:28:27,707] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:28:27,708] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:28:27,708] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:28:27,708] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7fd8b40b1950>, 'dag': <DAG: load_dimensions>, 'dag_run': <DagRun load_dimensions @ 2021-12-31 01:00:00+00:00: scheduled__2021-12-31T01:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2021-12-31', 'ds_nodash': '20211231', 'execution_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2021-12-31', 'next_ds_nodash': '20211231', 'next_execution_date': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': DateTime(2021, 12, 31, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2021-12-31T01:00:00+00:00', 'task': <Task(PythonOperator): tweet_load>, 'task_instance': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'task_instance_key_str': 'load_dimensions__tweet_load__20211231', 'test_mode': False, 'ti': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-01', 'tomorrow_ds_nodash': '20220101', 'ts': '2021-12-31T01:00:00+00:00', 'ts_nodash': '20211231T010000', 'ts_nodash_with_tz': '20211231T010000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-30', 'yesterday_ds_nodash': '20211230', 'key': 'value', 'ts_var': '2021-12-31T01:00:00+00:00', 'tsnodash_var': '20211231T010000', 'templates_dict': None}
[2022-01-05 06:28:27,708] {logging_mixin.py:109} INFO - Hello, Current Time:06:28:27 Execution time is 2021-12-31T01:00:00+00:00
[2022-01-05 06:28:27,733] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 06:28:27,749] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 06:28:29,238] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
psycopg2.errors.StringDataRightTruncation: value too long for type character varying(256)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/load_redshift.py", line 139, in load_tweets
    tweet_data.to_sql('tweet', redshift_hook.get_sqlalchemy_engine(), if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1350, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 882, in _execute_insert
    conn.execute(self.table.insert(), data)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1011, in execute
    return meth(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 298, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1130, in _execute_clauseelement
    distilled_params,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1317, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1511, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(256)

[SQL: INSERT INTO tweet (id, author_id, created_at, original_text, location) VALUES (%(id)s, %(author_id)s, %(created_at)s, %(original_text)s, %(location)s)]
[parameters: ({'id': 1284477302223634433, 'author_id': 1284477302223634433, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': "One common #OriginOfCovid misunderstanding is that early Covid-19 cases were linked to market stalls selling wildlife.\n\nThere's actually no data to support the claim, and the data provided by the China-@WHO joint study, whether you trust it or not, contradicts the claim.", 'location': 'California'}, {'id': 127997053, 'author_id': 127997053, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': 'Por favor cudate del covid y no beses a nadie que no sea yo el viernes', 'location': None}, {'id': 1321873703785930754, 'author_id': 1321873703785930754, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': 'BREAKING: Florida mayor Jerry Demmings blasts Governor DeSantis, accuses him of cowering and hiding as his reckless COVID policies backfire and the Omicron variant ravages the state, asking, Where is Ron DeSantis now!? RT TO THANK MAYOR DEMMINGS FOR CALLING DEATHSANTIS OUT!', 'location': 'Eastern NC'}, {'id': 1056811681899257857, 'author_id': 1056811681899257857, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': 'Follow The Science? Twitter Suspends mRNA Vaccine Inventor Dr. Robert Malone Who Questioned COVID Jab https://t.co/EOuda8tNja via @redvoicemedias', 'location': 'White Rabbit St, MATRIX '}, {'id': 759804041459273728, 'author_id': 759804041459273728, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': "@Nanookbn @RLurieCTV good news for us, we aren't getting sick, it's all of you who took the experimental that are super spreaders now. How does it feel to have risked your life, lost your freedoms and visitors prohibited and curfew.  Nothing changed but your health!", 'location': 'Montral, Qubec'}, {'id': 218854536, 'author_id': 218854536, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': 'JUST IN\n\nThe group behind the #Lawan series of protests are suing the govt and police for alleged violations of fundamental liberties during a Covi ... (7 characters truncated) ... ndlelight vigil held earlier this year.\n\nIn August, 30 people were hauled up and compounded for participating in the event. https://t.co/gRQqgsxZPZ', 'location': 'malaysia'}, {'id': 1135956772282413056, 'author_id': 1135956772282413056, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': 'Un da ms sin pillar el covid.\nUn da menos para pillarlo.', 'location': 'Islas Canarias'}, {'id': 987480088961691648, 'author_id': 987480088961691648, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': '"The Amarillo Public Health Department reported  17 new deaths in Wednesday\'s COVID-19 report card." This is what happens when your Congressman spews disinformation about the effectiveness of vaccinations and masks. @RonnyJacksonTX', 'location': None}, {'id': 1450632043, 'author_id': 1450632043, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': 'The U.S. just reported 484,377 new covid cases, the world record for the whole pandemic. And our governments response is to get people back to work.', 'location': 'amor fati'}, {'id': 1307340897680584705, 'author_id': 1307340897680584705, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': '#EnVideo| COVID-19 | Venezuela registr 200 casos comunitarios, 3 importados y 433.208 pacientes recuperados\n\n#AbrazaLaVida \n\nhttps://t.co/tXRZTmdeGh', 'location': None})]
(Background on this error at: http://sqlalche.me/e/13/9h9h)
[2022-01-05 06:28:29,333] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=load_dimensions, task_id=tweet_load, execution_date=20211231T010000, start_date=20220105T062827, end_date=20220105T062829
[2022-01-05 06:28:29,369] {standard_task_runner.py:92} ERROR - Failed to execute job 249 for task tweet_load
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
psycopg2.errors.StringDataRightTruncation: value too long for type character varying(256)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/load_redshift.py", line 139, in load_tweets
    tweet_data.to_sql('tweet', redshift_hook.get_sqlalchemy_engine(), if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1350, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 882, in _execute_insert
    conn.execute(self.table.insert(), data)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1011, in execute
    return meth(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 298, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1130, in _execute_clauseelement
    distilled_params,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1317, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1511, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(256)

[SQL: INSERT INTO tweet (id, author_id, created_at, original_text, location) VALUES (%(id)s, %(author_id)s, %(created_at)s, %(original_text)s, %(location)s)]
[parameters: ({'id': 1284477302223634433, 'author_id': 1284477302223634433, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': "One common #OriginOfCovid misunderstanding is that early Covid-19 cases were linked to market stalls selling wildlife.\n\nThere's actually no data to support the claim, and the data provided by the China-@WHO joint study, whether you trust it or not, contradicts the claim.", 'location': 'California'}, {'id': 127997053, 'author_id': 127997053, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': 'Por favor cudate del covid y no beses a nadie que no sea yo el viernes', 'location': None}, {'id': 1321873703785930754, 'author_id': 1321873703785930754, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': 'BREAKING: Florida mayor Jerry Demmings blasts Governor DeSantis, accuses him of cowering and hiding as his reckless COVID policies backfire and the Omicron variant ravages the state, asking, Where is Ron DeSantis now!? RT TO THANK MAYOR DEMMINGS FOR CALLING DEATHSANTIS OUT!', 'location': 'Eastern NC'}, {'id': 1056811681899257857, 'author_id': 1056811681899257857, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': 'Follow The Science? Twitter Suspends mRNA Vaccine Inventor Dr. Robert Malone Who Questioned COVID Jab https://t.co/EOuda8tNja via @redvoicemedias', 'location': 'White Rabbit St, MATRIX '}, {'id': 759804041459273728, 'author_id': 759804041459273728, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': "@Nanookbn @RLurieCTV good news for us, we aren't getting sick, it's all of you who took the experimental that are super spreaders now. How does it feel to have risked your life, lost your freedoms and visitors prohibited and curfew.  Nothing changed but your health!", 'location': 'Montral, Qubec'}, {'id': 218854536, 'author_id': 218854536, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': 'JUST IN\n\nThe group behind the #Lawan series of protests are suing the govt and police for alleged violations of fundamental liberties during a Covi ... (7 characters truncated) ... ndlelight vigil held earlier this year.\n\nIn August, 30 people were hauled up and compounded for participating in the event. https://t.co/gRQqgsxZPZ', 'location': 'malaysia'}, {'id': 1135956772282413056, 'author_id': 1135956772282413056, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': 'Un da ms sin pillar el covid.\nUn da menos para pillarlo.', 'location': 'Islas Canarias'}, {'id': 987480088961691648, 'author_id': 987480088961691648, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': '"The Amarillo Public Health Department reported  17 new deaths in Wednesday\'s COVID-19 report card." This is what happens when your Congressman spews disinformation about the effectiveness of vaccinations and masks. @RonnyJacksonTX', 'location': None}, {'id': 1450632043, 'author_id': 1450632043, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': 'The U.S. just reported 484,377 new covid cases, the world record for the whole pandemic. And our governments response is to get people back to work.', 'location': 'amor fati'}, {'id': 1307340897680584705, 'author_id': 1307340897680584705, 'created_at': '2021-12-31T01:09:59.000Z', 'original_text': '#EnVideo| COVID-19 | Venezuela registr 200 casos comunitarios, 3 importados y 433.208 pacientes recuperados\n\n#AbrazaLaVida \n\nhttps://t.co/tXRZTmdeGh', 'location': None})]
(Background on this error at: http://sqlalche.me/e/13/9h9h)
[2022-01-05 06:28:29,405] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-05 06:28:29,492] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-05 06:31:59,668] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 06:31:59,716] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 06:31:59,716] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 06:31:59,716] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-05 06:31:59,717] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 06:31:59,787] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): tweet_load> on 2021-12-31 01:00:00+00:00
[2022-01-05 06:31:59,812] {standard_task_runner.py:52} INFO - Started process 3215 to run task
[2022-01-05 06:31:59,826] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'load_dimensions', 'tweet_load', 'scheduled__2021-12-31T01:00:00+00:00', '--job-id', '267', '--raw', '--subdir', 'DAGS_FOLDER/load_redshift.py', '--cfg-path', '/tmp/tmpw0u6p07m', '--error-file', '/tmp/tmp59r73kim']
[2022-01-05 06:31:59,827] {standard_task_runner.py:77} INFO - Job 267: Subtask tweet_load
[2022-01-05 06:32:00,113] {logging_mixin.py:109} INFO - Running <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]> on host 2b1d65872a35
[2022-01-05 06:32:00,329] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=test_owner
AIRFLOW_CTX_DAG_ID=load_dimensions
AIRFLOW_CTX_TASK_ID=tweet_load
AIRFLOW_CTX_EXECUTION_DATE=2021-12-31T01:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-12-31T01:00:00+00:00
[2022-01-05 06:32:00,334] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:32:00,334] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:32:00,335] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:32:00,335] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:32:00,335] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:32:00,335] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:32:00,335] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:32:00,335] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:32:00,335] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:32:00,336] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:32:00,336] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:32:00,336] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 06:32:00,336] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7fd8b40b1950>, 'dag': <DAG: load_dimensions>, 'dag_run': <DagRun load_dimensions @ 2021-12-31 01:00:00+00:00: scheduled__2021-12-31T01:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2021-12-31', 'ds_nodash': '20211231', 'execution_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2021-12-31', 'next_ds_nodash': '20211231', 'next_execution_date': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': DateTime(2021, 12, 31, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2021-12-31T01:00:00+00:00', 'task': <Task(PythonOperator): tweet_load>, 'task_instance': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'task_instance_key_str': 'load_dimensions__tweet_load__20211231', 'test_mode': False, 'ti': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-01', 'tomorrow_ds_nodash': '20220101', 'ts': '2021-12-31T01:00:00+00:00', 'ts_nodash': '20211231T010000', 'ts_nodash_with_tz': '20211231T010000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-30', 'yesterday_ds_nodash': '20211230', 'key': 'value', 'ts_var': '2021-12-31T01:00:00+00:00', 'tsnodash_var': '20211231T010000', 'templates_dict': None}
[2022-01-05 06:32:00,337] {logging_mixin.py:109} INFO - Hello, Current Time:06:32:00 Execution time is 2021-12-31T01:00:00+00:00
[2022-01-05 06:32:00,429] {warnings.py:110} WARNING - /opt/***/dags/load_redshift.py:137: FutureWarning: In a future version of pandas all arguments of DataFrame.drop except for the argument 'labels' will be keyword-only
  tweet_data = tweet_data.drop('original_text', 1)

[2022-01-05 06:32:00,641] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 06:32:00,684] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 06:32:16,709] {python.py:175} INFO - Done. Returned value was: None
[2022-01-05 06:32:16,722] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=load_dimensions, task_id=tweet_load, execution_date=20211231T010000, start_date=20220105T063159, end_date=20220105T063216
[2022-01-05 06:32:16,762] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-05 06:32:16,799] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-05 07:02:30,986] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 07:02:31,053] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 07:02:31,053] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 07:02:31,053] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-05 07:02:31,053] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 07:02:31,101] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): tweet_load> on 2021-12-31 01:00:00+00:00
[2022-01-05 07:02:31,108] {standard_task_runner.py:52} INFO - Started process 121 to run task
[2022-01-05 07:02:31,116] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'load_dimensions', 'tweet_load', 'scheduled__2021-12-31T01:00:00+00:00', '--job-id', '322', '--raw', '--subdir', 'DAGS_FOLDER/load_redshift.py', '--cfg-path', '/tmp/tmpien3lxsb', '--error-file', '/tmp/tmp1z3kmbst']
[2022-01-05 07:02:31,127] {standard_task_runner.py:77} INFO - Job 322: Subtask tweet_load
[2022-01-05 07:02:31,327] {logging_mixin.py:109} INFO - Running <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]> on host e544fdb7c66e
[2022-01-05 07:02:31,508] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=test_owner
AIRFLOW_CTX_DAG_ID=load_dimensions
AIRFLOW_CTX_TASK_ID=tweet_load
AIRFLOW_CTX_EXECUTION_DATE=2021-12-31T01:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-12-31T01:00:00+00:00
[2022-01-05 07:02:31,510] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 07:02:31,511] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 07:02:31,511] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 07:02:31,511] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 07:02:31,512] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 07:02:31,512] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 07:02:31,512] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 07:02:31,512] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 07:02:31,512] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 07:02:31,512] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 07:02:31,513] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 07:02:31,513] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 07:02:31,513] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7fa6a9eda8d0>, 'dag': <DAG: load_dimensions>, 'dag_run': <DagRun load_dimensions @ 2021-12-31 01:00:00+00:00: scheduled__2021-12-31T01:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2021-12-31', 'ds_nodash': '20211231', 'execution_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2021-12-31', 'next_ds_nodash': '20211231', 'next_execution_date': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': DateTime(2021, 12, 31, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2021-12-31T01:00:00+00:00', 'task': <Task(PythonOperator): tweet_load>, 'task_instance': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'task_instance_key_str': 'load_dimensions__tweet_load__20211231', 'test_mode': False, 'ti': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-01', 'tomorrow_ds_nodash': '20220101', 'ts': '2021-12-31T01:00:00+00:00', 'ts_nodash': '20211231T010000', 'ts_nodash_with_tz': '20211231T010000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-30', 'yesterday_ds_nodash': '20211230', 'key': 'value', 'ts_var': '2021-12-31T01:00:00+00:00', 'tsnodash_var': '20211231T010000', 'templates_dict': None}
[2022-01-05 07:02:31,513] {logging_mixin.py:109} INFO - Hello, Current Time:07:02:31 Execution time is 2021-12-31T01:00:00+00:00
[2022-01-05 07:02:31,528] {warnings.py:110} WARNING - /opt/***/dags/load_redshift.py:137: FutureWarning: In a future version of pandas all arguments of DataFrame.drop except for the argument 'labels' will be keyword-only
  tweet_data = tweet_data.drop('original_text', 1)

[2022-01-05 07:02:31,607] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 07:02:31,662] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 07:02:34,756] {python.py:175} INFO - Done. Returned value was: None
[2022-01-05 07:02:34,766] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=load_dimensions, task_id=tweet_load, execution_date=20211231T010000, start_date=20220105T070231, end_date=20220105T070234
[2022-01-05 07:02:34,819] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-05 07:02:34,854] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-05 07:04:27,399] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 07:04:27,413] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 07:04:27,413] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 07:04:27,414] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-05 07:04:27,414] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 07:04:27,428] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): tweet_load> on 2021-12-31 01:00:00+00:00
[2022-01-05 07:04:27,436] {standard_task_runner.py:52} INFO - Started process 258 to run task
[2022-01-05 07:04:27,442] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'load_dimensions', 'tweet_load', 'scheduled__2021-12-31T01:00:00+00:00', '--job-id', '342', '--raw', '--subdir', 'DAGS_FOLDER/load_redshift.py', '--cfg-path', '/tmp/tmp0y88ahlp', '--error-file', '/tmp/tmpg6gssqva']
[2022-01-05 07:04:27,444] {standard_task_runner.py:77} INFO - Job 342: Subtask tweet_load
[2022-01-05 07:04:27,507] {logging_mixin.py:109} INFO - Running <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]> on host e544fdb7c66e
[2022-01-05 07:04:27,589] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=test_owner
AIRFLOW_CTX_DAG_ID=load_dimensions
AIRFLOW_CTX_TASK_ID=tweet_load
AIRFLOW_CTX_EXECUTION_DATE=2021-12-31T01:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-12-31T01:00:00+00:00
[2022-01-05 07:04:27,590] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 07:04:27,591] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 07:04:27,591] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 07:04:27,591] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 07:04:27,591] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 07:04:27,591] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 07:04:27,591] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 07:04:27,591] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 07:04:27,591] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 07:04:27,591] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 07:04:27,591] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 07:04:27,591] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 07:04:27,592] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7fa6a9eda8d0>, 'dag': <DAG: load_dimensions>, 'dag_run': <DagRun load_dimensions @ 2021-12-31 01:00:00+00:00: scheduled__2021-12-31T01:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2021-12-31', 'ds_nodash': '20211231', 'execution_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2021-12-31', 'next_ds_nodash': '20211231', 'next_execution_date': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': DateTime(2021, 12, 31, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2021-12-31T01:00:00+00:00', 'task': <Task(PythonOperator): tweet_load>, 'task_instance': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'task_instance_key_str': 'load_dimensions__tweet_load__20211231', 'test_mode': False, 'ti': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-01', 'tomorrow_ds_nodash': '20220101', 'ts': '2021-12-31T01:00:00+00:00', 'ts_nodash': '20211231T010000', 'ts_nodash_with_tz': '20211231T010000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-30', 'yesterday_ds_nodash': '20211230', 'key': 'value', 'ts_var': '2021-12-31T01:00:00+00:00', 'tsnodash_var': '20211231T010000', 'templates_dict': None}
[2022-01-05 07:04:27,592] {logging_mixin.py:109} INFO - Hello, Current Time:07:04:27 Execution time is 2021-12-31T01:00:00+00:00
[2022-01-05 07:04:27,604] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 07:04:27,610] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 07:04:41,447] {python.py:175} INFO - Done. Returned value was: None
[2022-01-05 07:04:41,456] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=load_dimensions, task_id=tweet_load, execution_date=20211231T010000, start_date=20220105T070427, end_date=20220105T070441
[2022-01-05 07:04:41,506] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-05 07:04:41,530] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-05 18:45:37,802] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 18:45:37,858] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 18:45:37,858] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 18:45:37,859] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-05 18:45:37,859] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 18:45:37,900] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): tweet_load> on 2021-12-31 01:00:00+00:00
[2022-01-05 18:45:37,917] {standard_task_runner.py:52} INFO - Started process 730 to run task
[2022-01-05 18:45:37,932] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'load_dimensions', 'tweet_load', 'scheduled__2021-12-31T01:00:00+00:00', '--job-id', '373', '--raw', '--subdir', 'DAGS_FOLDER/load_redshift.py', '--cfg-path', '/tmp/tmpt80x61ft', '--error-file', '/tmp/tmpmed7yb_l']
[2022-01-05 18:45:37,933] {standard_task_runner.py:77} INFO - Job 373: Subtask tweet_load
[2022-01-05 18:45:38,126] {logging_mixin.py:109} INFO - Running <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]> on host e544fdb7c66e
[2022-01-05 18:45:38,675] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=test_owner
AIRFLOW_CTX_DAG_ID=load_dimensions
AIRFLOW_CTX_TASK_ID=tweet_load
AIRFLOW_CTX_EXECUTION_DATE=2021-12-31T01:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-12-31T01:00:00+00:00
[2022-01-05 18:45:38,678] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 18:45:38,679] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 18:45:38,679] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 18:45:38,679] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 18:45:38,679] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 18:45:38,680] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 18:45:38,680] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 18:45:38,680] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 18:45:38,680] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 18:45:38,680] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 18:45:38,681] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 18:45:38,681] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 18:45:38,681] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7ffaccd8cb10>, 'dag': <DAG: load_dimensions>, 'dag_run': <DagRun load_dimensions @ 2021-12-31 01:00:00+00:00: scheduled__2021-12-31T01:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2021-12-31', 'ds_nodash': '20211231', 'execution_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2021-12-31', 'next_ds_nodash': '20211231', 'next_execution_date': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': DateTime(2021, 12, 31, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2021-12-31T01:00:00+00:00', 'task': <Task(PythonOperator): tweet_load>, 'task_instance': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'task_instance_key_str': 'load_dimensions__tweet_load__20211231', 'test_mode': False, 'ti': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-01', 'tomorrow_ds_nodash': '20220101', 'ts': '2021-12-31T01:00:00+00:00', 'ts_nodash': '20211231T010000', 'ts_nodash_with_tz': '20211231T010000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-30', 'yesterday_ds_nodash': '20211230', 'key': 'value', 'ts_var': '2021-12-31T01:00:00+00:00', 'tsnodash_var': '20211231T010000', 'templates_dict': None}
[2022-01-05 18:45:38,682] {logging_mixin.py:109} INFO - Hello, Current Time:18:45:38 Execution time is 2021-12-31T01:00:00+00:00
[2022-01-05 18:45:38,764] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 18:45:38,799] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 18:45:42,555] {python.py:175} INFO - Done. Returned value was: None
[2022-01-05 18:45:42,570] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=load_dimensions, task_id=tweet_load, execution_date=20211231T010000, start_date=20220105T184537, end_date=20220105T184542
[2022-01-05 18:45:42,612] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-05 18:45:42,651] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-05 18:46:39,742] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 18:46:39,772] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 18:46:39,773] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 18:46:39,773] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-05 18:46:39,773] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 18:46:39,866] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): tweet_load> on 2021-12-31 01:00:00+00:00
[2022-01-05 18:46:39,942] {standard_task_runner.py:52} INFO - Started process 842 to run task
[2022-01-05 18:46:39,975] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'load_dimensions', 'tweet_load', 'scheduled__2021-12-31T01:00:00+00:00', '--job-id', '395', '--raw', '--subdir', 'DAGS_FOLDER/load_redshift.py', '--cfg-path', '/tmp/tmpfcyjss39', '--error-file', '/tmp/tmpk46n1_95']
[2022-01-05 18:46:39,977] {standard_task_runner.py:77} INFO - Job 395: Subtask tweet_load
[2022-01-05 18:46:40,234] {logging_mixin.py:109} INFO - Running <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]> on host e544fdb7c66e
[2022-01-05 18:46:40,476] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=test_owner
AIRFLOW_CTX_DAG_ID=load_dimensions
AIRFLOW_CTX_TASK_ID=tweet_load
AIRFLOW_CTX_EXECUTION_DATE=2021-12-31T01:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-12-31T01:00:00+00:00
[2022-01-05 18:46:40,477] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 18:46:40,478] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 18:46:40,478] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 18:46:40,478] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 18:46:40,478] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 18:46:40,478] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 18:46:40,479] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 18:46:40,479] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 18:46:40,479] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 18:46:40,479] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 18:46:40,479] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 18:46:40,479] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 18:46:40,480] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7ffaccd8cb10>, 'dag': <DAG: load_dimensions>, 'dag_run': <DagRun load_dimensions @ 2021-12-31 01:00:00+00:00: scheduled__2021-12-31T01:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2021-12-31', 'ds_nodash': '20211231', 'execution_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2021-12-31', 'next_ds_nodash': '20211231', 'next_execution_date': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': DateTime(2021, 12, 31, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2021-12-31T01:00:00+00:00', 'task': <Task(PythonOperator): tweet_load>, 'task_instance': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'task_instance_key_str': 'load_dimensions__tweet_load__20211231', 'test_mode': False, 'ti': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-01', 'tomorrow_ds_nodash': '20220101', 'ts': '2021-12-31T01:00:00+00:00', 'ts_nodash': '20211231T010000', 'ts_nodash_with_tz': '20211231T010000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-30', 'yesterday_ds_nodash': '20211230', 'key': 'value', 'ts_var': '2021-12-31T01:00:00+00:00', 'tsnodash_var': '20211231T010000', 'templates_dict': None}
[2022-01-05 18:46:40,480] {logging_mixin.py:109} INFO - Hello, Current Time:18:46:40 Execution time is 2021-12-31T01:00:00+00:00
[2022-01-05 18:46:40,506] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 18:46:40,523] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 18:46:42,783] {python.py:175} INFO - Done. Returned value was: None
[2022-01-05 18:46:42,936] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=load_dimensions, task_id=tweet_load, execution_date=20211231T010000, start_date=20220105T184639, end_date=20220105T184642
[2022-01-05 18:46:43,085] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-05 18:46:43,223] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-05 19:23:53,161] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 19:23:53,193] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 19:23:53,193] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 19:23:53,193] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-05 19:23:53,193] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 19:23:53,221] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): tweet_load> on 2021-12-31 01:00:00+00:00
[2022-01-05 19:23:53,229] {standard_task_runner.py:52} INFO - Started process 2653 to run task
[2022-01-05 19:23:53,240] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'load_dimensions', 'tweet_load', 'scheduled__2021-12-31T01:00:00+00:00', '--job-id', '444', '--raw', '--subdir', 'DAGS_FOLDER/load_redshift.py', '--cfg-path', '/tmp/tmp4bla6ksm', '--error-file', '/tmp/tmpyaia6nmt']
[2022-01-05 19:23:53,241] {standard_task_runner.py:77} INFO - Job 444: Subtask tweet_load
[2022-01-05 19:23:53,412] {logging_mixin.py:109} INFO - Running <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]> on host e544fdb7c66e
[2022-01-05 19:23:53,675] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=test_owner
AIRFLOW_CTX_DAG_ID=load_dimensions
AIRFLOW_CTX_TASK_ID=tweet_load
AIRFLOW_CTX_EXECUTION_DATE=2021-12-31T01:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-12-31T01:00:00+00:00
[2022-01-05 19:23:53,677] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:23:53,678] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:23:53,678] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:23:53,678] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:23:53,678] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:23:53,679] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:23:53,679] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:23:53,679] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:23:53,682] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:23:53,683] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:23:53,683] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:23:53,683] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:23:53,684] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7ffaccd8cb10>, 'dag': <DAG: load_dimensions>, 'dag_run': <DagRun load_dimensions @ 2021-12-31 01:00:00+00:00: scheduled__2021-12-31T01:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2021-12-31', 'ds_nodash': '20211231', 'execution_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2021-12-31', 'next_ds_nodash': '20211231', 'next_execution_date': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': DateTime(2021, 12, 31, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2021-12-31T01:00:00+00:00', 'task': <Task(PythonOperator): tweet_load>, 'task_instance': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'task_instance_key_str': 'load_dimensions__tweet_load__20211231', 'test_mode': False, 'ti': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-01', 'tomorrow_ds_nodash': '20220101', 'ts': '2021-12-31T01:00:00+00:00', 'ts_nodash': '20211231T010000', 'ts_nodash_with_tz': '20211231T010000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-30', 'yesterday_ds_nodash': '20211230', 'key': 'value', 'ts_var': '2021-12-31T01:00:00+00:00', 'tsnodash_var': '20211231T010000', 'templates_dict': None}
[2022-01-05 19:23:53,684] {logging_mixin.py:109} INFO - Hello, Current Time:19:23:53 Execution time is 2021-12-31T01:00:00+00:00
[2022-01-05 19:23:53,739] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 19:23:53,774] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 19:23:56,505] {python.py:175} INFO - Done. Returned value was: None
[2022-01-05 19:23:56,533] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=load_dimensions, task_id=tweet_load, execution_date=20211231T010000, start_date=20220105T192353, end_date=20220105T192356
[2022-01-05 19:23:56,619] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-05 19:23:56,704] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-05 19:28:21,457] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 19:28:21,491] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 19:28:21,492] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 19:28:21,492] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-05 19:28:21,492] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 19:28:21,540] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): tweet_load> on 2021-12-31 01:00:00+00:00
[2022-01-05 19:28:21,550] {standard_task_runner.py:52} INFO - Started process 2904 to run task
[2022-01-05 19:28:21,564] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'load_dimensions', 'tweet_load', 'scheduled__2021-12-31T01:00:00+00:00', '--job-id', '462', '--raw', '--subdir', 'DAGS_FOLDER/load_redshift.py', '--cfg-path', '/tmp/tmpgk8ov4hj', '--error-file', '/tmp/tmp5r2qread']
[2022-01-05 19:28:21,565] {standard_task_runner.py:77} INFO - Job 462: Subtask tweet_load
[2022-01-05 19:28:21,762] {logging_mixin.py:109} INFO - Running <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]> on host e544fdb7c66e
[2022-01-05 19:28:21,894] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=test_owner
AIRFLOW_CTX_DAG_ID=load_dimensions
AIRFLOW_CTX_TASK_ID=tweet_load
AIRFLOW_CTX_EXECUTION_DATE=2021-12-31T01:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-12-31T01:00:00+00:00
[2022-01-05 19:28:21,895] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:28:21,896] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:28:21,896] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:28:21,896] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:28:21,896] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:28:21,896] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:28:21,896] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:28:21,897] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:28:21,897] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:28:21,897] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:28:21,897] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:28:21,897] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:28:21,898] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7ffaccd8cb10>, 'dag': <DAG: load_dimensions>, 'dag_run': <DagRun load_dimensions @ 2021-12-31 01:00:00+00:00: scheduled__2021-12-31T01:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2021-12-31', 'ds_nodash': '20211231', 'execution_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2021-12-31', 'next_ds_nodash': '20211231', 'next_execution_date': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': DateTime(2021, 12, 31, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2021-12-31T01:00:00+00:00', 'task': <Task(PythonOperator): tweet_load>, 'task_instance': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'task_instance_key_str': 'load_dimensions__tweet_load__20211231', 'test_mode': False, 'ti': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-01', 'tomorrow_ds_nodash': '20220101', 'ts': '2021-12-31T01:00:00+00:00', 'ts_nodash': '20211231T010000', 'ts_nodash_with_tz': '20211231T010000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-30', 'yesterday_ds_nodash': '20211230', 'key': 'value', 'ts_var': '2021-12-31T01:00:00+00:00', 'tsnodash_var': '20211231T010000', 'templates_dict': None}
[2022-01-05 19:28:21,898] {logging_mixin.py:109} INFO - Hello, Current Time:19:28:21 Execution time is 2021-12-31T01:00:00+00:00
[2022-01-05 19:28:21,920] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 19:28:21,932] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 19:28:24,456] {python.py:175} INFO - Done. Returned value was: None
[2022-01-05 19:28:24,490] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=load_dimensions, task_id=tweet_load, execution_date=20211231T010000, start_date=20220105T192821, end_date=20220105T192824
[2022-01-05 19:28:24,580] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-05 19:28:24,675] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-05 19:29:18,715] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 19:29:18,739] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [queued]>
[2022-01-05 19:29:18,739] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 19:29:18,740] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-05 19:29:18,740] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-05 19:29:18,759] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): tweet_load> on 2021-12-31 01:00:00+00:00
[2022-01-05 19:29:18,767] {standard_task_runner.py:52} INFO - Started process 3025 to run task
[2022-01-05 19:29:18,772] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'load_dimensions', 'tweet_load', 'scheduled__2021-12-31T01:00:00+00:00', '--job-id', '488', '--raw', '--subdir', 'DAGS_FOLDER/load_redshift.py', '--cfg-path', '/tmp/tmp2fv9pfz7', '--error-file', '/tmp/tmpuz538e5_']
[2022-01-05 19:29:18,773] {standard_task_runner.py:77} INFO - Job 488: Subtask tweet_load
[2022-01-05 19:29:18,847] {logging_mixin.py:109} INFO - Running <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]> on host e544fdb7c66e
[2022-01-05 19:29:18,941] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=test_owner
AIRFLOW_CTX_DAG_ID=load_dimensions
AIRFLOW_CTX_TASK_ID=tweet_load
AIRFLOW_CTX_EXECUTION_DATE=2021-12-31T01:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-12-31T01:00:00+00:00
[2022-01-05 19:29:18,942] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:29:18,943] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:29:18,943] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:29:18,943] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:29:18,943] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:29:18,943] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:29:18,943] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:29:18,943] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:29:18,943] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:29:18,944] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:29:18,944] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:29:18,944] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-05 19:29:18,944] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7ffaccd8cb10>, 'dag': <DAG: load_dimensions>, 'dag_run': <DagRun load_dimensions @ 2021-12-31 01:00:00+00:00: scheduled__2021-12-31T01:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2021-12-31', 'ds_nodash': '20211231', 'execution_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2021, 12, 31, 1, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2021-12-31', 'next_ds_nodash': '20211231', 'next_execution_date': DateTime(2021, 12, 31, 2, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': DateTime(2021, 12, 31, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2021-12-31T01:00:00+00:00', 'task': <Task(PythonOperator): tweet_load>, 'task_instance': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'task_instance_key_str': 'load_dimensions__tweet_load__20211231', 'test_mode': False, 'ti': <TaskInstance: load_dimensions.tweet_load scheduled__2021-12-31T01:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-01', 'tomorrow_ds_nodash': '20220101', 'ts': '2021-12-31T01:00:00+00:00', 'ts_nodash': '20211231T010000', 'ts_nodash_with_tz': '20211231T010000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-30', 'yesterday_ds_nodash': '20211230', 'key': 'value', 'ts_var': '2021-12-31T01:00:00+00:00', 'tsnodash_var': '20211231T010000', 'templates_dict': None}
[2022-01-05 19:29:18,944] {logging_mixin.py:109} INFO - Hello, Current Time:19:29:18 Execution time is 2021-12-31T01:00:00+00:00
[2022-01-05 19:29:18,962] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 19:29:18,976] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: tweetdb, Login: awsuser, Password: ***, extra: {}
[2022-01-05 19:29:21,577] {python.py:175} INFO - Done. Returned value was: None
[2022-01-05 19:29:21,596] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=load_dimensions, task_id=tweet_load, execution_date=20211231T010000, start_date=20220105T192918, end_date=20220105T192921
[2022-01-05 19:29:21,635] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-05 19:29:21,675] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
